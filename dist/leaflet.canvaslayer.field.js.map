{"version":3,"sources":["webpack:///webpack/bootstrap 989fdb83080b847231b3","webpack:///./Cell.js","webpack:///./Field.js","webpack:///./ScalarField.js","webpack:///./Vector.js","webpack:///./VectorField.js","webpack:///./control/L.Control.ColorBar.js","webpack:///./layer/L.CanvasLayer.Field.js","webpack:///./layer/L.CanvasLayer.ScalarField.js","webpack:///./layer/L.CanvasLayer.SimpleLonLat.js","webpack:///./layer/L.CanvasLayer.VectorFieldAnim.js","webpack:///./layer/L.CanvasLayer.js","webpack:///../~/@turf/inside/index.js","webpack:///../~/@turf/invariant/index.js","webpack:///./_main.js"],"names":["Cell","center","value","xSize","ySize","anotherCell","equals","_equalValues","anotherValue","type","constructor","name","answerFor","Number","Vector","u","v","halfX","halfY","cLat","lat","cLng","lng","ul","L","latLng","lr","latLngBounds","Field","params","nCols","nRows","width","height","xllCorner","yllCorner","xurCorner","yurCorner","cellXSize","cellYSize","grid","isContinuous","longitudeNeedsToBeWrapped","_inFilter","_spatialMask","TypeError","range","_calculateRange","stride","cells","j","i","_lonLatAtIndexes","lon","_valueAtIndexes","c","push","f","_updateRange","m","_getWrappedLongitudes","xmin","xmax","_pointInMask","_pointInExtent","longitudeIn","latitudeIn","pt","geometry","coordinates","properties","poly","inside","contains","notContains","_getDecimalIndexes","interpolatedValueAtIndexes","indexes","_getFourSurroundingIndexes","fi","ci","fj","cj","values","_getFourSurroundingValues","g00","g10","g01","g11","_doInterpolation","Math","floor","_clampColumnIndex","_clampRowIndex","row","_isValid","ii","jj","valueAt","hasValue","included","hasValueAt","o","random","x","_longitudeAtX","y","_latitudeAtY","halfXPixel","halfYPixel","maxCol","maxRow","undefined","ScalarField","asc","scaleFactor","lines","split","header","_parseASCIIGridHeader","slice","zs","length","line","trim","items","forEach","floatItem","parseFloat","it","noDataValue","p","headerLines","headerItems","map","filter","param","toUpperCase","usesCorner","cellSize","parseInt","err","Error","data","bandIndex","multipleFromGeoTIFF","bandIndexes","tiff","GeoTIFF","parse","image","getImage","rasters","readRasters","tiepoint","getTiePoints","fileDirectory","getFileDirectory","ModelPixelScale","xScale","yScale","Array","keys","scalarFields","GDAL_NODATA","noData","simpleZS","from","z","getWidth","getHeight","_buildGrid","_arrayTo2d","array","d3","min","max","rx","ry","sqrt","verticalAngle","atan2","inDegrees","PI","a","directionTo","opposite","VectorField","ascU","ascV","fromASCIIGrid","_paramsFromScalarFields","gtU","gtV","fromGeoTIFF","geotiffData","bandIndexesForUV","us","vs","_getFunctionFor","_applyOnField","uv","func","n","numCells","_arraysTo2d","valid","vectors","getCells","magnitudes","magnitude","b","d","Control","ColorBar","extend","options","position","margin","background","textColor","steps","decimals","units","title","labels","textLabels","labelFontSize","labelTextPosition","initialize","color","Util","setOptions","onAdd","_map","div","DomUtil","create","style","padding","DomEvent","addListener","stopPropagation","preventDefault","backgroundColor","cursor","innerHTML","palette","document","createElement","select","append","attr","text","svg","_createSvgIn","_appendColorBarTo","_appendLabelsTo","spaceForLabels","colorPerValue","_getColorPerValue","w","groupBars","buckets","selectAll","enter","hex","toFixed","positionPerLabelValue","_getPositionPerLabelValue","groupLabels","label","delta","xPositionFor","scaleLinear","domain","positionPerLabel","index","control","colorBar","CanvasLayer","mouseMoveCursor","noValue","opacity","onClick","onMouseMove","inFilter","field","_visible","setData","getEvents","events","prototype","call","zoomstart","_hideCanvas","bind","zoomend","_showCanvas","onLayerDidMount","_enableIdentify","_ensureCanvasAlignment","show","hide","_disableIdentify","isVisible","_canvas","visibility","on","_onClick","_onMouseMove","off","topLeft","containerPointToLayerPoint","setPosition","onLayerWillUnmount","needRedraw","_field","onDrawLayer","viewInfo","setFilter","fire","setOpacity","_updateOpacity","getBounds","bb","extent","southWest","northEast","bounds","e","_queryValue","_changeCursorOn","getContainer","latlng","result","_getDrawingContext","g","getContext","clearRect","interpolate","vectorSize","arrowDirection","scalarField","_defaultColorScale","chroma","scale","setColor","r","_getRendererMethod","_drawImage","_drawArrows","_ensureColor","ctx","img","createImageData","_prepareImageIn","putImageData","pos","pointCoords","containerPointToLatLng","_getColorFor","rgba","R","G","B","A","_pixelBounds","pixelSize","strokeStyle","currentBounds","cell","_drawArrow","northWest","latLngToContainerPoint","getNorthWest","southEast","getSouthEast","pixelBounds","projected","size","save","translate","rotationRads","rotate","beginPath","moveTo","lineTo","stroke","restore","canvasLayer","SimpleLonLat","points","canvas","fillStyle","point","layer","fillRect","fill","closePath","xs","ys","ymin","ymax","simpleLonLat","lonslats","VectorFieldAnim","paths","fade","duration","maxAge","velocityScale","vectorField","timer","_stopAnimation","_prepareParticlePaths","_moveParticles","_drawParticles","self","par","age","randomPosition","vector","xt","yt","prev","globalCompositeOperation","lineWidth","_drawParticle","source","target","pA","pB","_randomAge","stop","vectorFieldAnim","Layer","_frame","_delegate","delegate","del","requestAnimFrame","drawLayer","_onLayerDidResize","resizeEvent","newSize","_onLayerDidMove","resize","moveend","zoomAnimation","Browser","any3d","zoomanim","_animateZoom","tiles","getSize","animated","addClass","_panes","overlayPane","appendChild","onRemove","getPanes","removeChild","addTo","addLayer","LatLonToMercator","latlon","log","tan","zoom","getZoom","getCenter","corner","getZoomScale","offset","_latLngToNewLayerPoint","setTransform","window","require"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;AChEA;;;IAGqBA,I;AACjB;;;;;;;AAOA,kBAAYC,MAAZ,EAAoBC,KAApB,EAA2BC,KAA3B,EAAiD;AAAA,YAAfC,KAAe,uEAAPD,KAAO;;AAAA;;AAC7C,aAAKF,MAAL,GAAcA,MAAd;AACA,aAAKC,KAAL,GAAaA,KAAb;AACA,aAAKC,KAAL,GAAaA,KAAb;AACA,aAAKC,KAAL,GAAaA,KAAb;AACH;;;;+BAEMC,W,EAAa;AAChB,mBACI,KAAKJ,MAAL,CAAYK,MAAZ,CAAmBD,YAAYJ,MAA/B,KACA,KAAKM,YAAL,CAAkB,KAAKL,KAAvB,EAA8BG,YAAYH,KAA1C,CADA,IAEA,KAAKC,KAAL,KAAeE,YAAYF,KAF3B,IAGA,KAAKC,KAAL,KAAeC,YAAYD,KAJ/B;AAMH;;;qCAEYF,K,EAAOM,Y,EAAc;AAC9B,gBAAIC,OAAOP,MAAMQ,WAAN,CAAkBC,IAA7B;AACA,gBAAIC,YAAY;AACZC,wBAAQX,UAAUM,YADN;AAEZM,wBAAQZ,MAAMa,CAAN,KAAYP,aAAaO,CAAzB,IAA8Bb,MAAMc,CAAN,KAAYR,aAAaQ;AAFnD,aAAhB;AAIA,mBAAOJ,UAAUH,IAAV,CAAP;AACH;;AAED;;;;;;;oCAIY;AACR,gBAAIQ,QAAQ,KAAKd,KAAL,GAAa,GAAzB;AACA,gBAAIe,QAAQ,KAAKd,KAAL,GAAa,GAAzB;AACA,gBAAIe,OAAO,KAAKlB,MAAL,CAAYmB,GAAvB;AACA,gBAAIC,OAAO,KAAKpB,MAAL,CAAYqB,GAAvB;AACA,gBAAIC,KAAKC,EAAEC,MAAF,CAAS,CAACN,OAAOD,KAAR,EAAeG,OAAOJ,KAAtB,CAAT,CAAT;AACA,gBAAIS,KAAKF,EAAEC,MAAF,CAAS,CAACN,OAAOD,KAAR,EAAeG,OAAOJ,KAAtB,CAAT,CAAT;;AAEA,mBAAOO,EAAEG,YAAF,CACHH,EAAEC,MAAF,CAASC,GAAGN,GAAZ,EAAiBG,GAAGD,GAApB,CADG,EAEHE,EAAEC,MAAF,CAASF,GAAGH,GAAZ,EAAiBM,GAAGJ,GAApB,CAFG,CAAP;AAIH;;;;;;yDAjDgBtB,I;;;;;;;;;;;;;;;;ACHrB;AACA;;AAEA;;;;;IAIqB4B,K;AACjB,mBAAYC,MAAZ,EAAoB;AAAA;;AAChB,aAAKA,MAAL,GAAcA,MAAd;;AAEA,aAAKC,KAAL,GAAaD,OAAO,OAAP,CAAb;AACA,aAAKE,KAAL,GAAaF,OAAO,OAAP,CAAb;;AAEA;AACA,aAAKG,KAAL,GAAaH,OAAO,OAAP,CAAb;AACA,aAAKI,MAAL,GAAcJ,OAAO,OAAP,CAAd;;AAEA;AACA,aAAKK,SAAL,GAAiBL,OAAO,WAAP,CAAjB;AACA,aAAKM,SAAL,GAAiBN,OAAO,WAAP,CAAjB;;AAEA;AACA,aAAKO,SAAL,GACIP,OAAO,WAAP,IAAsBA,OAAO,OAAP,IAAkBA,OAAO,WAAP,CAD5C;AAEA,aAAKQ,SAAL,GACIR,OAAO,WAAP,IAAsBA,OAAO,OAAP,IAAkBA,OAAO,WAAP,CAD5C;;AAGA,aAAKS,SAAL,GAAiBT,OAAO,WAAP,CAAjB;AACA,aAAKU,SAAL,GAAiBV,OAAO,WAAP,CAAjB;;AAEA,aAAKW,IAAL,GAAY,IAAZ,CAvBgB,CAuBE;AAClB,aAAKC,YAAL,GAAoB,KAAKL,SAAL,GAAiB,KAAKF,SAAtB,IAAmC,GAAvD;AACA,aAAKQ,yBAAL,GAAiC,KAAKN,SAAL,GAAiB,GAAlD,CAzBgB,CAyBuC;;AAEvD,aAAKO,SAAL,GAAiB,IAAjB;AACA,aAAKC,YAAL,GAAoB,IAApB;AACH;;AAED;;;;;;;;;;;;qCAQa;AACT,kBAAM,IAAIC,SAAJ,CAAc,mBAAd,CAAN;AACH;;;uCAEc;AACX,iBAAKC,KAAL,GAAa,KAAKC,eAAL,EAAb;AACH;;AAED;;;;;;;mCAIW;AACP,mBAAO,KAAKhB,KAAL,GAAa,KAAKD,KAAzB;AACH;;AAED;;;;;;;mCAIqB;AAAA,gBAAZkB,MAAY,uEAAH,CAAG;;AACjB,gBAAIC,QAAQ,EAAZ;AACA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,KAAKnB,KAAzB,EAAgCmB,IAAIA,IAAIF,MAAxC,EAAgD;AAC5C,qBAAK,IAAIG,IAAI,CAAb,EAAgBA,IAAI,KAAKrB,KAAzB,EAAgCqB,IAAIA,IAAIH,MAAxC,EAAgD;AAAA,4CAC3B,KAAKI,gBAAL,CAAsBD,CAAtB,EAAyBD,CAAzB,CAD2B;AAAA;AAAA,wBACvCG,GADuC;AAAA,wBAClCjC,GADkC;;AAE5C,wBAAInB,SAASuB,EAAEC,MAAF,CAASL,GAAT,EAAciC,GAAd,CAAb;AACA,wBAAInD,QAAQ,KAAKoD,eAAL,CAAqBH,CAArB,EAAwBD,CAAxB,CAAZ;AACA,wBAAIK,IAAI,IAAI,sDAAJ,CAAStD,MAAT,EAAiBC,KAAjB,EAAwB,KAAKoC,SAA7B,EAAwC,KAAKC,SAA7C,CAAR;AACAU,0BAAMO,IAAN,CAAWD,CAAX,EAL4C,CAK7B;AAClB;AACJ;AACD,mBAAON,KAAP;AACH;;AAED;;;;;;;kCAIUQ,C,EAAG;AACT,iBAAKd,SAAL,GAAiBc,CAAjB;AACA,iBAAKC,YAAL;AACH;;AAED;;;;;;;uCAIeC,C,EAAG;AACd,iBAAKf,YAAL,GAAoBe,CAApB;AACH;;AAED;;;;;;;iCAIS;AAAA,yCACc,KAAKC,qBAAL,EADd;AAAA;AAAA,gBACAC,IADA;AAAA,gBACMC,IADN;;AAEL,mBAAO,CAACD,IAAD,EAAO,KAAK1B,SAAZ,EAAuB2B,IAAvB,EAA6B,KAAKzB,SAAlC,CAAP;AACH;;AAED;;;;;;gDAGwB;AACpB,gBAAIwB,OAAO,KAAK3B,SAAhB;AACA,gBAAI4B,OAAO,KAAK1B,SAAhB;;AAEA,gBAAI,KAAKM,yBAAT,EAAoC;AAChC,oBAAI,KAAKD,YAAT,EAAuB;AACnBoB,2BAAO,CAAC,GAAR;AACAC,2BAAO,GAAP;AACH,iBAHD,MAGO;AACH;AACAA,2BAAO,KAAK1B,SAAL,GAAiB,GAAxB;AACAyB,2BAAO,KAAK3B,SAAL,GAAiB,GAAxB;AACA;AACA;AACA;AACA;AACH;AACJ;AACD,mBAAO,CAAC2B,IAAD,EAAOC,IAAP,CAAP;AACH;;AAED;;;;;;;;;;iCAOST,G,EAAKjC,G,EAAK;AACf,gBAAI,KAAKwB,YAAT,EAAuB;AACnB,uBAAO,KAAKmB,YAAL,CAAkBV,GAAlB,EAAuBjC,GAAvB,CAAP;AACH;AACD,mBAAO,KAAK4C,cAAL,CAAoBX,GAApB,EAAyBjC,GAAzB,CAAP;AACH;;AAED;;;;;;;;uCAKeiC,G,EAAKjC,G,EAAK;AAAA,yCACF,KAAKwC,qBAAL,EADE;AAAA;AAAA,gBAChBC,IADgB;AAAA,gBACVC,IADU;;AAErB,gBAAIG,cAAcZ,OAAOQ,IAAP,IAAeR,OAAOS,IAAxC;AACA,gBAAII,aAAa9C,OAAO,KAAKe,SAAZ,IAAyBf,OAAO,KAAKiB,SAAtD;AACA,mBAAO4B,eAAeC,UAAtB;AACH;;AAED;;;;;;;;qCAKab,G,EAAKjC,G,EAAK;AACnB,gBAAM+C,KAAK;AACP1D,sBAAM,SADC;AAEP2D,0BAAU;AACN3D,0BAAM,OADA;AAEN4D,iCAAa,CAAChB,GAAD,EAAMjC,GAAN,CAFP,CAEkB;AAFlB,iBAFH;AAMPkD,4BAAY;AANL,aAAX;AAQA,gBAAMC,OAAO,KAAK3B,YAAlB;AACA,mBAAO,oDAAA4B,CAAOL,EAAP,EAAWI,IAAX,CAAP;AACH;;AAED;;;;;;;;;oCAMYlB,G,EAAKjC,G,EAAK;AAClB,mBAAO,CAAC,KAAKqD,QAAL,CAAcpB,GAAd,EAAmBjC,GAAnB,CAAR;AACH;;AAED;;;;;;;;;;;4CAQoBiC,G,EAAKjC,G,EAAK;AAC1B,gBAAI,KAAKsD,WAAL,CAAiBrB,GAAjB,EAAsBjC,GAAtB,CAAJ,EAAgC,OAAO,IAAP;;AADN,sCAGb,KAAKuD,kBAAL,CAAwBtB,GAAxB,EAA6BjC,GAA7B,CAHa;AAAA;AAAA,gBAGrB+B,CAHqB;AAAA,gBAGlBD,CAHkB;;AAI1B,mBAAO,KAAK0B,0BAAL,CAAgCzB,CAAhC,EAAmCD,CAAnC,CAAP;AACH;;AAED;;;;;;;;;;;mDAQ2BC,C,EAAGD,C,EAAG;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAI2B,UAAU,KAAKC,0BAAL,CAAgC3B,CAAhC,EAAmCD,CAAnC,CAAd;;AAV6B,0CAWN2B,OAXM;AAAA,gBAWxBE,EAXwB;AAAA,gBAWpBC,EAXoB;AAAA,gBAWhBC,EAXgB;AAAA,gBAWZC,EAXY;;AAY7B,gBAAIC,SAAS,KAAKC,yBAAL,CAA+BL,EAA/B,EAAmCC,EAAnC,EAAuCC,EAAvC,EAA2CC,EAA3C,CAAb;AACA,gBAAIC,MAAJ,EAAY;AAAA,6CACmBA,MADnB;AAAA,oBACHE,GADG;AAAA,oBACEC,GADF;AAAA,oBACOC,GADP;AAAA,oBACYC,GADZ;;AAER,uBAAO,KAAKC,gBAAL,CAAsBtC,IAAI4B,EAA1B,EAA8B7B,IAAI+B,EAAlC,EAAsCI,GAAtC,EAA2CC,GAA3C,EAAgDC,GAAhD,EAAqDC,GAArD,CAAP;AACH;AACD,mBAAO,IAAP;AACH;;AAED;;;;;;;;;;2CAOmBnC,G,EAAKjC,G,EAAK;AACzB,gBAAI,KAAKsB,yBAAL,IAAkCW,MAAM,KAAKnB,SAAjD,EAA4D;AACxDmB,sBAAMA,MAAM,GAAZ;AACH;AACD,gBAAIF,IAAI,CAACE,MAAM,KAAKnB,SAAZ,IAAyB,KAAKI,SAAtC;AACA,gBAAIY,IAAI,CAAC,KAAKb,SAAL,GAAiBjB,GAAlB,IAAyB,KAAKmB,SAAtC;AACA,mBAAO,CAACY,CAAD,EAAID,CAAJ,CAAP;AACH;;AAED;;;;;;;;;;mDAO2BC,C,EAAGD,C,EAAG;AAC7B,gBAAI6B,KAAKW,KAAKC,KAAL,CAAWxC,CAAX,CAAT;AACA,gBAAI6B,KAAKD,KAAK,CAAd;AACA;AACA,gBAAI,KAAKtC,YAAL,IAAqBuC,MAAM,KAAKlD,KAApC,EAA2C;AACvCkD,qBAAK,CAAL;AACH;AACDA,iBAAK,KAAKY,iBAAL,CAAuBZ,EAAvB,CAAL;;AAEA,gBAAIC,KAAK,KAAKY,cAAL,CAAoBH,KAAKC,KAAL,CAAWzC,CAAX,CAApB,CAAT;AACA,gBAAIgC,KAAK,KAAKW,cAAL,CAAoBZ,KAAK,CAAzB,CAAT;;AAEA,mBAAO,CAACF,EAAD,EAAKC,EAAL,EAASC,EAAT,EAAaC,EAAb,CAAP;AACH;;AAED;;;;;;;;;;;;;kDAU0BH,E,EAAIC,E,EAAIC,E,EAAIC,E,EAAI;AACtC,gBAAIY,GAAJ;AACA,gBAAKA,MAAM,KAAKtD,IAAL,CAAUyC,EAAV,CAAX,EAA2B;AACvB;AACA,oBAAII,MAAMS,IAAIf,EAAJ,CAAV,CAFuB,CAEJ;AACnB,oBAAIO,MAAMQ,IAAId,EAAJ,CAAV,CAHuB,CAGJ;AACnB,oBACI,KAAKe,QAAL,CAAcV,GAAd,KACA,KAAKU,QAAL,CAAcT,GAAd,CADA,KAECQ,MAAM,KAAKtD,IAAL,CAAU0C,EAAV,CAFP,CADJ,EAIE;AACE;AACA,wBAAIK,MAAMO,IAAIf,EAAJ,CAAV,CAFF,CAEqB;AACnB,wBAAIS,MAAMM,IAAId,EAAJ,CAAV,CAHF,CAGqB;AACnB,wBAAI,KAAKe,QAAL,CAAcR,GAAd,KAAsB,KAAKQ,QAAL,CAAcP,GAAd,CAA1B,EAA8C;AAC1C,+BAAO,CAACH,GAAD,EAAMC,GAAN,EAAWC,GAAX,EAAgBC,GAAhB,CAAP,CAD0C,CACb;AAChC;AACJ;AACJ;AACD,mBAAO,IAAP;AACH;;AAED;;;;;;;;;gCAMQnC,G,EAAKjC,G,EAAK;AACd,gBAAI,KAAKsD,WAAL,CAAiBrB,GAAjB,EAAsBjC,GAAtB,CAAJ,EAAgC,OAAO,IAAP;;AADlB,sCAGD,KAAKuD,kBAAL,CAAwBtB,GAAxB,EAA6BjC,GAA7B,CAHC;AAAA;AAAA,gBAGT+B,CAHS;AAAA,gBAGND,CAHM;;AAId,gBAAI8C,KAAKN,KAAKC,KAAL,CAAWxC,CAAX,CAAT;AACA,gBAAI8C,KAAKP,KAAKC,KAAL,CAAWzC,CAAX,CAAT;;AAEA,gBAAM8B,KAAK,KAAKY,iBAAL,CAAuBI,EAAvB,CAAX;AACA,gBAAMd,KAAK,KAAKW,cAAL,CAAoBI,EAApB,CAAX;;AAEA,gBAAI/F,QAAQ,KAAKoD,eAAL,CAAqB0B,EAArB,EAAyBE,EAAzB,CAAZ;AACA,gBAAI,KAAKvC,SAAT,EAAoB;AAChB,oBAAI,CAAC,KAAKA,SAAL,CAAezC,KAAf,CAAL,EAA4B,OAAO,IAAP;AAC/B;;AAED,mBAAOA,KAAP;AACH;;AAED;;;;;;;;;mCAMWmD,G,EAAKjC,G,EAAK;AACjB,gBAAIlB,QAAQ,KAAKgG,OAAL,CAAa7C,GAAb,EAAkBjC,GAAlB,CAAZ;AACA,gBAAI+E,WAAWjG,UAAU,IAAzB;;AAEA,gBAAIkG,WAAW,IAAf;AACA,gBAAI,KAAKzD,SAAT,EAAoB;AAChByD,2BAAW,KAAKzD,SAAL,CAAezC,KAAf,CAAX;AACH;AACD,mBAAOiG,YAAYC,QAAnB;AACH;;AAED;;;;;;;;;sCAMc/C,G,EAAKjC,G,EAAK;AACpB,mBAAO,CAAC,KAAKiF,UAAL,CAAgBhD,GAAhB,EAAqBjC,GAArB,CAAR;AACH;;AAED;;;;;;;;yCAKuB;AAAA,gBAARkF,CAAQ,uEAAJ,EAAI;;AACnB,gBAAInD,IAAKuC,KAAKa,MAAL,KAAgB,KAAKzE,KAAtB,GAA+B,CAAvC;AACA,gBAAIoB,IAAKwC,KAAKa,MAAL,KAAgB,KAAKxE,KAAtB,GAA+B,CAAvC;;AAEAuE,cAAEE,CAAF,GAAM,KAAKC,aAAL,CAAmBtD,CAAnB,CAAN;AACAmD,cAAEI,CAAF,GAAM,KAAKC,YAAL,CAAkBzD,CAAlB,CAAN;;AAEA,mBAAOoD,CAAP;AACH;;AAED;;;;;;;;;wCAMgBnD,C,EAAGD,C,EAAG;AAClB,mBAAO,KAAKV,IAAL,CAAUU,CAAV,EAAaC,CAAb,CAAP,CADkB,CACM;AAC3B;;AAED;;;;;;;;;yCAMiBA,C,EAAGD,C,EAAG;AACnB,gBAAIG,MAAM,KAAKoD,aAAL,CAAmBtD,CAAnB,CAAV;AACA,gBAAI/B,MAAM,KAAKuF,YAAL,CAAkBzD,CAAlB,CAAV;;AAEA,mBAAO,CAACG,GAAD,EAAMjC,GAAN,CAAP;AACH;;AAED;;;;;;;;sCAKc+B,C,EAAG;AACb,gBAAIyD,aAAa,KAAKtE,SAAL,GAAiB,GAAlC;AACA,gBAAIe,MAAM,KAAKnB,SAAL,GAAiB0E,UAAjB,GAA8BzD,IAAI,KAAKb,SAAjD;AACA,gBAAI,KAAKI,yBAAT,EAAoC;AAChCW,sBAAMA,MAAM,GAAN,GAAYA,MAAM,GAAlB,GAAwBA,GAA9B;AACH;AACD,mBAAOA,GAAP;AACH;;AAED;;;;;;;;qCAKaH,C,EAAG;AACZ,gBAAI2D,aAAa,KAAKtE,SAAL,GAAiB,GAAlC;AACA,mBAAO,KAAKF,SAAL,GAAiBwE,UAAjB,GAA8B3D,IAAI,KAAKX,SAA9C;AACH;;AAED;;;;;AAKA;;;;yCACiBiE,C,EAAGE,C,EAAGrB,G,EAAKC,G,EAAKC,G,EAAKC,G,EAAK;AACvC,kBAAM,IAAI3C,SAAJ,CAAc,mBAAd,CAAN;AACH;AACD;;AAEA;;;;;;;;;;0CAOkBmD,E,EAAI;AAClB,gBAAI7C,IAAI6C,EAAR;AACA,gBAAIA,KAAK,CAAT,EAAY;AACR7C,oBAAI,CAAJ;AACH;AACD,gBAAI2D,SAAS,KAAKhF,KAAL,GAAa,CAA1B;AACA,gBAAIkE,KAAKc,MAAT,EAAiB;AACb3D,oBAAI2D,MAAJ;AACH;AACD,mBAAO3D,CAAP;AACH;;AAED;;;;;;;;;;uCAOe8C,E,EAAI;AACf,gBAAI/C,IAAI+C,EAAR;AACA,gBAAIA,KAAK,CAAT,EAAY;AACR/C,oBAAI,CAAJ;AACH;AACD,gBAAI6D,SAAS,KAAKhF,KAAL,GAAa,CAA1B;AACA,gBAAIkE,KAAKc,MAAT,EAAiB;AACb7D,oBAAI6D,MAAJ;AACH;AACD,mBAAO7D,CAAP;AACH;;AAED;;;;;;;;;iCAMSsD,C,EAAG;AACR,mBAAOA,MAAM,IAAN,IAAcA,MAAMQ,SAA3B;AACH;;;;;;yDA7cgBpF,K;;;;;;;;;;;;;;;;;;;;;;ACPrB;;AAEA;;;;IAGqBqF,W;;;;;;AACjB;;;;;sCAKqBC,G,EAAsB;AAAA,gBAAjBC,WAAiB,uEAAH,CAAG;;AACvC;;AAEA,gBAAIC,QAAQF,IAAIG,KAAJ,CAAU,IAAV,CAAZ;;AAEA;AACA,gBAAIC,SAASL,YAAYM,qBAAZ,CAAkCH,MAAMI,KAAN,CAAY,CAAZ,EAAe,CAAf,CAAlC,CAAb;;AAEA;AACA,gBAAIC,KAAK,EAAT;AACA,iBAAK,IAAItE,IAAI,CAAb,EAAgBA,IAAIiE,MAAMM,MAA1B,EAAkCvE,GAAlC,EAAuC;AACnC,oBAAIwE,OAAOP,MAAMjE,CAAN,EAASyE,IAAT,EAAX;AACA,oBAAID,SAAS,EAAb,EAAiB;;AAEjB,oBAAIE,QAAQF,KAAKN,KAAL,CAAW,GAAX,CAAZ;AACAQ,sBAAMC,OAAN,CAAc,cAAM;AAChB,wBAAIC,YAAYC,WAAWC,EAAX,CAAhB;AACA,wBAAIjH,IACA+G,cAAcT,OAAOY,WAArB,GACAH,YAAYZ,WADZ,GAEA,IAHJ;AAIAM,uBAAGjE,IAAH,CAAQxC,CAAR;AACH,iBAPD;AAQH;AACD,gBAAImH,IAAIb,MAAR;AACAa,cAAEV,EAAF,GAAOA,EAAP;;AAEA;AACA,mBAAO,IAAIR,WAAJ,CAAgBkB,CAAhB,CAAP;AACH;;AAED;;;;;;;;8CAK6BC,W,EAAa;AACtC,gBAAI;AACA,oBAAMC,cAAcD,YAAYE,GAAZ,CAAgB,gBAAQ;AACxC,wBAAIT,QAAQF,KAAKN,KAAL,CAAW,GAAX,EAAgBkB,MAAhB,CAAuB;AAAA,+BAAKpF,KAAK,EAAV;AAAA,qBAAvB,CAAZ;AACA,wBAAIqF,QAAQX,MAAM,CAAN,EAASD,IAAT,GAAgBa,WAAhB,EAAZ;AACA,wBAAIvI,QAAQ8H,WAAWH,MAAM,CAAN,EAASD,IAAT,EAAX,CAAZ;AACA,+CACKY,KADL,EACatI,KADb;AAGH,iBAPmB,CAApB;;AASA,oBAAMwI,aAAa,eAAeL,YAAY,CAAZ,CAAlC;AACA,oBAAMM,WAAWN,YAAY,CAAZ,EAAe,UAAf,CAAjB;;AAEA,oBAAMf,SAAS;AACXxF,2BAAO8G,SAASP,YAAY,CAAZ,EAAe,OAAf,CAAT,CADI;AAEXtG,2BAAO6G,SAASP,YAAY,CAAZ,EAAe,OAAf,CAAT,CAFI;AAGXnG,+BAAWwG,aACPL,YAAY,CAAZ,EAAe,WAAf,CADO,GAEPA,YAAY,CAAZ,EAAe,WAAf,IAA8BM,WAAW,CALlC;AAMXxG,+BAAWuG,aACPL,YAAY,CAAZ,EAAe,WAAf,CADO,GAEPA,YAAY,CAAZ,EAAe,WAAf,IAA8BM,WAAW,CARlC;AASXrG,+BAAWqG,QATA;AAUXpG,+BAAWoG,QAVA;AAWXT,iCAAaG,YAAY,CAAZ,EAAe,cAAf;AAXF,iBAAf;AAaA,uBAAOf,MAAP;AACH,aA3BD,CA2BE,OAAOuB,GAAP,EAAY;AACV,sBAAM,IAAIC,KAAJ,oCAA2CD,GAA3C,CAAN;AACH;AACJ;;AAED;;;;;;;;;oCAMmBE,I,EAAqB;AAAA,gBAAfC,SAAe,uEAAH,CAAG;;AACpC,mBAAO/B,YAAYgC,mBAAZ,CAAgCF,IAAhC,EAAsC,CAACC,SAAD,CAAtC,EAAmD,CAAnD,CAAP;AACH;;AAED;;;;;;;;;4CAM2BD,I,EAAMG,W,EAAa;AAC1C;;AAEA,gBAAIC,OAAOC,QAAQC,KAAR,CAAcN,IAAd,CAAX,CAH0C,CAGV;AAChC,gBAAIO,QAAQH,KAAKI,QAAL,EAAZ;AACA,gBAAIC,UAAUF,MAAMG,WAAN,EAAd;AACA,gBAAIC,WAAWJ,MAAMK,YAAN,GAAqB,CAArB,CAAf;AACA,gBAAIC,gBAAgBN,MAAMO,gBAAN,EAApB;;AAP0C,uDAQnBD,cAAcE,eARK;AAAA,gBAQrCC,MARqC;AAAA,gBAQ7BC,MAR6B;;AAU1C,gBAAI,OAAOd,WAAP,KAAuB,WAAvB,IAAsCA,YAAYxB,MAAZ,KAAuB,CAAjE,EAAoE;AAChEwB,2DAAkBe,MAAMT,QAAQ9B,MAAd,EAAsBwC,IAAtB,EAAlB;AACH;;AAED,gBAAIC,eAAe,EAAnB;AACAA,2BAAejB,YAAYZ,GAAZ,CAAgB,UAAUU,SAAV,EAAqB;AAChD,oBAAIvB,KAAK+B,QAAQR,SAAR,CAAT,CADgD,CACnB;;AAE7B,oBAAIY,cAAcQ,WAAlB,EAA+B;AAC3B,wBAAIC,SAASrC,WAAW4B,cAAcQ,WAAzB,CAAb;AACA;AACA,wBAAIE,WAAWL,MAAMM,IAAN,CAAW9C,EAAX,CAAf,CAH2B,CAGI;AAC/BA,yBAAK6C,SAAShC,GAAT,CAAa,UAAUkC,CAAV,EAAa;AAC3B,+BAAOA,MAAMH,MAAN,GAAe,IAAf,GAAsBG,CAA7B;AACH,qBAFI,CAAL;AAGH;;AAED,oBAAIrC,IAAI;AACJrG,2BAAOwH,MAAMmB,QAAN,EADH;AAEJ1I,2BAAOuH,MAAMoB,SAAN,EAFH;AAGJxI,+BAAWwH,SAASlD,CAHhB;AAIJrE,+BAAWuH,SAAShD,CAAT,GAAa4C,MAAMoB,SAAN,KAAoBV,MAJxC;AAKJ1H,+BAAWyH,MALP;AAMJxH,+BAAWyH,MANP;AAOJvC,wBAAIA;AAPA,iBAAR;AASA,uBAAO,IAAIR,WAAJ,CAAgBkB,CAAhB,CAAP;AACH,aAtBc,CAAf;;AAwBA;AACA,mBAAOgC,YAAP;AACH;;;AAED,yBAAYtI,MAAZ,EAAoB;AAAA;;AAAA,8HACVA,MADU;;AAEhB,cAAK4F,EAAL,GAAU5F,OAAO,IAAP,CAAV;;AAEA,cAAKW,IAAL,GAAY,MAAKmI,UAAL,EAAZ;AACA,cAAKjH,YAAL;AACA;AANgB;AAOnB;;AAED;;;;;;;;;;;qCAOa;AACT,gBAAIlB,OAAO,KAAKoI,UAAL,CAAgB,KAAKnD,EAArB,EAAyB,KAAK1F,KAA9B,EAAqC,KAAKD,KAA1C,CAAX;AACA,mBAAOU,IAAP;AACH;;;mCAEUqI,K,EAAO9I,K,EAAOD,K,EAAO;AAC5B,gBAAIU,OAAO,EAAX;AACA,gBAAI2F,IAAI,CAAR;AACA,iBAAK,IAAIjF,IAAI,CAAb,EAAgBA,IAAInB,KAApB,EAA2BmB,GAA3B,EAAgC;AAC5B,oBAAI4C,MAAM,EAAV;AACA,qBAAK,IAAI3C,IAAI,CAAb,EAAgBA,IAAIrB,KAApB,EAA2BqB,KAAKgF,GAAhC,EAAqC;AACjC,wBAAIqC,IAAIK,MAAM1C,CAAN,CAAR;AACArC,wBAAI3C,CAAJ,IAAS,KAAK4C,QAAL,CAAcyE,CAAd,IAAmBA,CAAnB,GAAuB,IAAhC,CAFiC,CAEK;AACzC;AACDhI,qBAAKU,CAAL,IAAU4C,GAAV;AACH;AACD,mBAAOtD,IAAP;AACH;;;uCAEcX,M,EAAQ;AACnBA,mBAAO,IAAP,IAAe,EAAf;AACH;;;2CAEkBA,M,EAAQ3B,K,EAAO;AAC9B2B,mBAAO,IAAP,EAAa2B,IAAb,CAAkBtD,KAAlB;AACH;;;qCAEY2B,M,EAAQ;AACjB,mBAAO,IAAIoF,WAAJ,CAAgBpF,MAAhB,CAAP;AACH;;AAED;;;;;;;;0CAKkB;AACd,gBAAIkH,OAAO,KAAKtB,EAAhB;AACA,gBAAI,KAAK9E,SAAT,EAAoB;AAChBoG,uBAAOA,KAAKR,MAAL,CAAY,KAAK5F,SAAjB,CAAP;AACH;AACD,mBAAO,CAACmI,GAAGC,GAAH,CAAOhC,IAAP,CAAD,EAAe+B,GAAGE,GAAH,CAAOjC,IAAP,CAAf,CAAP;AACH;;AAED;;;;;;;;;;;;;;yCAWiBvC,C,EAAGE,C,EAAGrB,G,EAAKC,G,EAAKC,G,EAAKC,G,EAAK;AACvC,gBAAIyF,KAAK,IAAIzE,CAAb;AACA,gBAAI0E,KAAK,IAAIxE,CAAb;AACA,mBAAOrB,MAAM4F,EAAN,GAAWC,EAAX,GAAgB5F,MAAMkB,CAAN,GAAU0E,EAA1B,GAA+B3F,MAAM0F,EAAN,GAAWvE,CAA1C,GAA8ClB,MAAMgB,CAAN,GAAUE,CAA/D;AACH;;;;EAjNoC,uD;;yDAApBO,W;;;;;;;;;;;ACLrB;;;IAGqBnG,M;AAEjB,oBAAYC,CAAZ,EAAeC,CAAf,EAAkB;AAAA;;AACd,aAAKD,CAAL,GAASA,CAAT;AACA,aAAKC,CAAL,GAASA,CAAT;AACH;;AAED;;;;;;;;oCAIY;AACR,mBAAO0E,KAAKyF,IAAL,CAAU,KAAKpK,CAAL,GAAS,KAAKA,CAAd,GAAkB,KAAKC,CAAL,GAAS,KAAKA,CAA1C,CAAP;AACH;;AAED;;;;;;;;sCAKc;AACV,gBAAIoK,gBAAgB1F,KAAK2F,KAAL,CAAW,KAAKtK,CAAhB,EAAmB,KAAKC,CAAxB,CAApB;AACA,gBAAIsK,YAAYF,iBAAiB,QAAQ1F,KAAK6F,EAA9B,CAAhB;AACA,gBAAID,YAAY,CAAhB,EAAmB;AACfA,4BAAYA,YAAY,KAAxB;AACH;AACD,mBAAOA,SAAP;AACH;;AAED;;;;;;;;wCAKgB;AACZ,gBAAIE,IAAI,KAAKC,WAAL,EAAR;AACA,gBAAIC,WAAW,CAACF,IAAI,KAAL,IAAc,KAA7B;AACA,mBAAOE,QAAP;AACH;;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;yDAxCiB5K,M;;;;;;;;;;;;;;;;;;;;ACHrB;AACA;AACA;;AAEA;;;;;IAIqB6K,W;;;;;;AACjB;;;;;;uCAMsBC,I,EAAMC,I,EAAuB;AAAA,gBAAjB1E,WAAiB,uEAAH,CAAG;;AAC/C,gBAAIpG,IAAI,6DAAAkG,CAAY6E,aAAZ,CAA0BF,IAA1B,EAAgCzE,WAAhC,CAAR;AACA,gBAAInG,IAAI,6DAAAiG,CAAY6E,aAAZ,CAA0BD,IAA1B,EAAgC1E,WAAhC,CAAR;AACA,gBAAIgB,IAAIwD,YAAYI,uBAAZ,CAAoChL,CAApC,EAAuCC,CAAvC,CAAR;;AAEA,mBAAO,IAAI2K,WAAJ,CAAgBxD,CAAhB,CAAP;AACH;;AAED;;;;;;;;;qCAMoB6D,G,EAAKC,G,EAAK;AAC1B,gBAAIlL,IAAI,6DAAAkG,CAAYiF,WAAZ,CAAwBF,GAAxB,CAAR;AACA,gBAAIhL,IAAI,6DAAAiG,CAAYiF,WAAZ,CAAwBD,GAAxB,CAAR;AACA,gBAAI9D,IAAIwD,YAAYI,uBAAZ,CAAoChL,CAApC,EAAuCC,CAAvC,CAAR;;AAEA,mBAAO,IAAI2K,WAAJ,CAAgBxD,CAAhB,CAAP;AACH;;AAED;;;;;;;;;6CAM4BgE,W,EAAwC;AAAA,gBAA3BC,gBAA2B,uEAAR,CAAC,CAAD,EAAI,CAAJ,CAAQ;;AAAA,wCACnD,6DAAAnF,CAAYgC,mBAAZ,CACTkD,WADS,EAETC,gBAFS,CADmD;AAAA;AAAA,gBAC3DrL,CAD2D;AAAA,gBACxDC,CADwD;;AAKhE,gBAAImH,IAAIwD,YAAYI,uBAAZ,CAAoChL,CAApC,EAAuCC,CAAvC,CAAR;;AAEA,mBAAO,IAAI2K,WAAJ,CAAgBxD,CAAhB,CAAP;AACH;;AAED;;;;;;;;;;;gDAQ+BpH,C,EAAGC,C,EAAG;AACjC;AACA,gBAAImH,IAAI;AACJrG,uBAAOf,EAAEe,KADL;AAEJC,uBAAOhB,EAAEgB,KAFL;AAGJG,2BAAWnB,EAAEmB,SAHT;AAIJC,2BAAWpB,EAAEoB,SAJT;AAKJG,2BAAWvB,EAAEuB,SALT;AAMJC,2BAAWxB,EAAEwB,SANT;AAOJ8J,oBAAItL,EAAE0G,EAPF;AAQJ6E,oBAAItL,EAAEyG;AARF,aAAR;AAUA,mBAAOU,CAAP;AACH;;;AAED,yBAAYtG,MAAZ,EAAoB;AAAA;;AAAA,8HACVA,MADU;;AAGhB,cAAKwK,EAAL,GAAUxK,OAAO,IAAP,CAAV;AACA,cAAKyK,EAAL,GAAUzK,OAAO,IAAP,CAAV;AACA,cAAKW,IAAL,GAAY,MAAKmI,UAAL,EAAZ;AACA,cAAK7H,KAAL,GAAa,MAAKC,eAAL,EAAb;AANgB;AAOnB;;AAED;;;;;;;;;;uCAMetC,I,EAAM;AACjB,gBAAIgD,IAAI,KAAK8I,eAAL,CAAqB9L,IAArB,CAAR;AACA,gBAAI0H,IAAI;AACJrG,uBAAO,KAAKD,MAAL,CAAYC,KADf;AAEJC,uBAAO,KAAKF,MAAL,CAAYE,KAFf;AAGJG,2BAAW,KAAKL,MAAL,CAAYK,SAHnB;AAIJC,2BAAW,KAAKN,MAAL,CAAYM,SAJnB;AAKJG,2BAAW,KAAKT,MAAL,CAAYS,SALnB;AAMJC,2BAAW,KAAKV,MAAL,CAAYU,SANnB;AAOJkF,oBAAI,KAAK+E,aAAL,CAAmB/I,CAAnB;AAPA,aAAR;AASA,mBAAO,IAAI,6DAAJ,CAAgB0E,CAAhB,CAAP;AACH;;;wCAEe1H,I,EAAM;AAClB,mBAAO,UAASM,CAAT,EAAYC,CAAZ,EAAe;AAClB,oBAAIyL,KAAK,IAAI,wDAAJ,CAAW1L,CAAX,EAAcC,CAAd,CAAT;AACA,uBAAOyL,GAAGhM,IAAH,GAAP,CAFkB,CAEC;AACtB,aAHD;AAIH;;;sCAEaiM,I,EAAM;AAChB,gBAAIjF,KAAK,EAAT;AACA,gBAAIkF,IAAI,KAAKC,QAAL,EAAR;AACA,iBAAK,IAAIzJ,IAAI,CAAb,EAAgBA,IAAIwJ,CAApB,EAAuBxJ,GAAvB,EAA4B;AACxB,oBAAIpC,IAAI,KAAKsL,EAAL,CAAQlJ,CAAR,CAAR;AACA,oBAAInC,IAAI,KAAKsL,EAAL,CAAQnJ,CAAR,CAAR;AACA,oBAAI,KAAK4C,QAAL,CAAchF,CAAd,KAAoB,KAAKgF,QAAL,CAAc/E,CAAd,CAAxB,EAA0C;AACtCyG,uBAAGjE,IAAH,CAAQkJ,KAAK3L,CAAL,EAAQC,CAAR,CAAR;AACH,iBAFD,MAEO;AACHyG,uBAAGjE,IAAH,CAAQ,IAAR;AACH;AACJ;AACD,mBAAOiE,EAAP;AACH;;AAED;;;;;;;;;qCAMa;AACT,gBAAIjF,OAAO,KAAKqK,WAAL,CAAiB,KAAKR,EAAtB,EAA0B,KAAKC,EAA/B,EAAmC,KAAKvK,KAAxC,EAA+C,KAAKD,KAApD,CAAX;AACA,mBAAOU,IAAP;AACH;;;oCAEW6J,E,EAAIC,E,EAAIvK,K,EAAOD,K,EAAO;AAC9B,gBAAIU,OAAO,EAAX;AACA,gBAAI2F,IAAI,CAAR;;AAEA,iBAAK,IAAIjF,IAAI,CAAb,EAAgBA,IAAInB,KAApB,EAA2BmB,GAA3B,EAAgC;AAC5B,oBAAI4C,MAAM,EAAV;AACA,qBAAK,IAAI3C,IAAI,CAAb,EAAgBA,IAAIrB,KAApB,EAA2BqB,KAAKgF,GAAhC,EAAqC;AACjC,wBAAIpH,IAAIsL,GAAGlE,CAAH,CAAR;AAAA,wBACInH,IAAIsL,GAAGnE,CAAH,CADR;AAEA,wBAAI2E,QAAQ,KAAK/G,QAAL,CAAchF,CAAd,KAAoB,KAAKgF,QAAL,CAAc/E,CAAd,CAAhC;AACA8E,wBAAI3C,CAAJ,IAAS2J,QAAQ,IAAI,wDAAJ,CAAW/L,CAAX,EAAcC,CAAd,CAAR,GAA2B,IAApC,CAJiC,CAIS;AAC7C;AACDwB,qBAAKU,CAAL,IAAU4C,GAAV;AACH;AACD,mBAAOtD,IAAP;AACH;;;uCAEcX,M,EAAQ;AACnBA,mBAAO,IAAP,IAAe,EAAf;AACAA,mBAAO,IAAP,IAAe,EAAf;AACH;;;2CACkBA,M,EAAQ3B,K,EAAO;AAC9B;AACA2B,mBAAO,IAAP,EAAa2B,IAAb,CAAkBtD,MAAMa,CAAxB;AACAc,mBAAO,IAAP,EAAa2B,IAAb,CAAkBtD,MAAMc,CAAxB;AACH;;;qCACYa,M,EAAQ;AACjB,mBAAO,IAAI8J,WAAJ,CAAgB9J,MAAhB,CAAP;AACH;;AAED;;;;;;;;0CAKkB;AACd;AACA,gBAAIkL,UAAU,KAAKC,QAAL,GACT1E,GADS,CACL;AAAA,uBAAMnE,GAAGjE,KAAT;AAAA,aADK,EAETqI,MAFS,CAEF,UAASvH,CAAT,EAAY;AAChB,uBAAOA,MAAM,IAAb;AACH,aAJS,CAAd;;AAMA,gBAAI,KAAK2B,SAAT,EAAoB;AAChBoK,0BAAUA,QAAQxE,MAAR,CAAe,KAAK5F,SAApB,CAAV;AACH;;AAED;AACA,gBAAIsK,aAAaF,QAAQzE,GAAR,CAAY;AAAA,uBAAKtH,EAAEkM,SAAF,EAAL;AAAA,aAAZ,CAAjB;AACA,gBAAInC,MAAMD,GAAGC,GAAH,CAAOkC,UAAP,CAAV;AACA,gBAAIjC,MAAMF,GAAGE,GAAH,CAAOiC,UAAP,CAAV;;AAEA,mBAAO,CAAClC,GAAD,EAAMC,GAAN,CAAP;AACH;;AAED;;;;;;;;;;;;;;yCAWiBxE,C,EAAGE,C,EAAGrB,G,EAAKC,G,EAAKC,G,EAAKC,G,EAAK;AACvC,gBAAIyF,KAAK,IAAIzE,CAAb;AACA,gBAAI0E,KAAK,IAAIxE,CAAb;AACA,gBAAI8E,IAAIP,KAAKC,EAAb;AAAA,gBACIiC,IAAI3G,IAAI0E,EADZ;AAAA,gBAEI3H,IAAI0H,KAAKvE,CAFb;AAAA,gBAGI0G,IAAI5G,IAAIE,CAHZ;AAIA,gBAAI3F,IAAIsE,IAAItE,CAAJ,GAAQyK,CAAR,GAAYlG,IAAIvE,CAAJ,GAAQoM,CAApB,GAAwB5H,IAAIxE,CAAJ,GAAQwC,CAAhC,GAAoCiC,IAAIzE,CAAJ,GAAQqM,CAApD;AACA,gBAAIpM,IAAIqE,IAAIrE,CAAJ,GAAQwK,CAAR,GAAYlG,IAAItE,CAAJ,GAAQmM,CAApB,GAAwB5H,IAAIvE,CAAJ,GAAQuC,CAAhC,GAAoCiC,IAAIxE,CAAJ,GAAQoM,CAApD;AACA,mBAAO,IAAI,wDAAJ,CAAWrM,CAAX,EAAcC,CAAd,CAAP;AACH;;AAED;;;;;;;;;iCAMSwF,C,EAAG;AACR,mBAAOA,MAAM,IAAN,IAAcA,MAAMQ,SAA3B;AACH;;;;EAxNoC,uD;;yDAApB2E,W;;;;;;;;ACRrB;;;;;;AAMAnK,EAAE6L,OAAF,CAAUC,QAAV,GAAqB9L,EAAE6L,OAAF,CAAUE,MAAV,CAAiB;AAClCC,aAAS;AACLC,kBAAU,YADL;AAELzL,eAAO,GAFF,EAEO;AACZC,gBAAQ,EAHH;AAILyL,gBAAQ,EAJH;AAKLC,oBAAY,MALP;AAMLC,mBAAW,OANN;AAOLC,eAAO,GAPF;AAQLC,kBAAU,CARL;AASLC,eAAO,KATF,EASS;AACdC,eAAO,QAVF,EAUY;AACjBC,gBAAQ,EAXH,EAWO;AACZC,oBAAY,EAZP,EAYW;AAChBC,uBAAe,EAbV;AAcLC,2BAAmB,QAdd,CAcuB;AAdvB,KADyB;;AAkBlCC,gBAAY,oBAAUC,KAAV,EAAiBxL,KAAjB,EAAwB0K,OAAxB,EAAiC;AACzC,aAAKc,KAAL,GAAaA,KAAb,CADyC,CACrB;AACpB,aAAKxL,KAAL,GAAaA,KAAb,CAFyC,CAErB;AACpBtB,UAAE+M,IAAF,CAAOC,UAAP,CAAkB,IAAlB,EAAwBhB,OAAxB;AACH,KAtBiC;;AAwBlCiB,WAAO,eAAUnG,GAAV,EAAe;AAClB,aAAKoG,IAAL,GAAYpG,GAAZ;AACA,YAAIqG,MAAMnN,EAAEoN,OAAF,CAAUC,MAAV,CACN,KADM,EAEN,sDAFM,CAAV;AAIAF,YAAIG,KAAJ,CAAUC,OAAV,GAAoB,MAApB;;AAEAvN,UAAEwN,QAAF,CACKC,WADL,CACiBN,GADjB,EACsB,OADtB,EAC+BnN,EAAEwN,QAAF,CAAWE,eAD1C,EAEKD,WAFL,CAEiBN,GAFjB,EAEsB,OAFtB,EAE+BnN,EAAEwN,QAAF,CAAWG,cAF1C;AAGAR,YAAIG,KAAJ,CAAUM,eAAV,GAA4B,KAAK5B,OAAL,CAAaG,UAAzC;AACAgB,YAAIG,KAAJ,CAAUO,MAAV,GAAmB,MAAnB;AACAV,YAAIW,SAAJ,GAAgB,KAAKtB,KAAL,KAAe,KAAKuB,OAAL,EAA/B;AACA,eAAOZ,GAAP;AACH,KAvCiC;;AAyClCX,WAAO,iBAAY;AACf,YAAIZ,IAAIoC,SAASC,aAAT,CAAuB,KAAvB,CAAR;AACA3E,WACK4E,MADL,CACYtC,CADZ,EAEKuC,MAFL,CAEY,MAFZ,EAGKb,KAHL,CAGW,OAHX,EAGoB,KAAKtB,OAAL,CAAaI,SAHjC,EAIKkB,KAJL,CAIW,SAJX,EAIsB,OAJtB,EAKKA,KALL,CAKW,eALX,EAK4B,KAL5B,EAMKc,IANL,CAMU,OANV,EAMmB,gCANnB,EAOKC,IAPL,CAOU,KAAKrC,OAAL,CAAaQ,KAPvB;AAQA,eAAOZ,EAAEkC,SAAT;AACH,KApDiC;;AAsDlCC,aAAS,mBAAY;AACjB,YAAInC,IAAIoC,SAASC,aAAT,CAAuB,KAAvB,CAAR;AACA,YAAIK,MAAM,KAAKC,YAAL,CAAkB3C,CAAlB,CAAV;;AAEA,aAAK4C,iBAAL,CAAuBF,GAAvB;;AAEA,YAAI,KAAKtC,OAAL,CAAaS,MAAjB,EAAyB;AACrB,iBAAKgC,eAAL,CAAqBH,GAArB;AACH;;AAED,eAAO1C,EAAEkC,SAAT;AACH,KAjEiC;;AAmElCS,kBAAc,sBAAU3C,CAAV,EAAa;AACvB,YAAI8C,iBAAiB,KAAK1C,OAAL,CAAaS,MAAb,GAAsB,KAAKT,OAAL,CAAaE,MAAnC,GAA4C,CAAjE;AACA,YAAIoC,MAAMhF,GACL4E,MADK,CACEtC,CADF,EAELuC,MAFK,CAEE,KAFF,EAGLC,IAHK,CAGA,OAHA,EAGS,KAAKpC,OAAL,CAAaxL,KAAb,GAAqB,KAAKwL,OAAL,CAAaE,MAAb,GAAsB,CAHpD,EAILkC,IAJK,CAIA,QAJA,EAIU,KAAKpC,OAAL,CAAavL,MAAb,GAAsBiO,cAJhC,CAAV;AAKA,eAAOJ,GAAP;AACH,KA3EiC;;AA6ElCE,uBAAmB,2BAAUF,GAAV,EAAe;AAAA;;AAC9B,YAAMK,gBAAgB,KAAKC,iBAAL,EAAtB;AACA,YAAMC,IAAI,KAAK7C,OAAL,CAAaxL,KAAb,GAAqBmO,cAAczI,MAA7C;;AAEA,YAAI4I,YAAYR,IAAIH,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,IAArB,EAA2B,kBAA3B,CAAhB;AACA,YAAIW,UAAUD,UACTE,SADS,CACC,MADD,EAETzH,IAFS,CAEJoH,aAFI,EAGTM,KAHS,GAITd,MAJS,CAIF,MAJE,CAAd;AAKAY,gBACKX,IADL,CACU,GADV,EACe,UAACxC,CAAD,EAAIjK,CAAJ;AAAA,mBAAUA,IAAIkN,CAAJ,GAAQ,MAAK7C,OAAL,CAAaE,MAA/B;AAAA,SADf,EAEKkC,IAFL,CAEU,GAFV,EAEe;AAAA,mBAAM,CAAN;AAAA,SAFf,EAGKA,IAHL,CAGU,QAHV,EAGoB;AAAA,mBAAM,MAAKpC,OAAL,CAAavL,MAAnB;AAAA,SAHpB,CAG8C,SAH9C,EAIK2N,IAJL,CAIU,OAJV,EAImB;AAAA,mBAAMS,CAAN;AAAA,SAJnB,EAKKT,IALL,CAKU,cALV,EAK0B,CAL1B,EAMKA,IANL,CAMU,gBANV,EAM4B,MAN5B,EAOKA,IAPL,CAOU,QAPV,EAOoB;AAAA,mBAAKxC,EAAEkB,KAAF,CAAQoC,GAAR,EAAL;AAAA,SAPpB,EAQKd,IARL,CAQU,MARV,EAQkB;AAAA,mBAAKxC,EAAEkB,KAAF,CAAQoC,GAAR,EAAL;AAAA,SARlB;AASAH,gBACKZ,MADL,CACY,OADZ,EAEKE,IAFL,CAGQ;AAAA,mBACGzC,EAAElN,KAAF,CAAQyQ,OAAR,CAAgB,MAAKnD,OAAL,CAAaM,QAA7B,CADH,SAC6C,MAAKN,OAAL,CACpCO,KAFT;AAAA,SAHR;AAOH,KAvGiC;;AAyGlCkC,qBAAiB,yBAAUH,GAAV,EAAe;AAAA;;AAC5B,YAAMc,wBAAwB,KAAKC,yBAAL,EAA9B;AACA;AACA,YAAIC,cAAchB,IAAIH,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,IAArB,EAA2B,iBAA3B,CAAlB;AACA,YAAI3B,SAAS6C,YACRN,SADQ,CACE,MADF,EAERzH,IAFQ,CAEH6H,qBAFG,EAGRH,KAHQ,GAIRd,MAJQ,CAID,MAJC,CAAb;AAKA1B,eACK2B,IADL,CACU,GADV,EACe;AAAA,mBAAKxC,EAAEK,QAAF,GAAa,OAAKD,OAAL,CAAaE,MAA/B;AAAA,SADf,EAEKkC,IAFL,CAEU,GAFV,EAEe,KAAKpC,OAAL,CAAavL,MAAb,GAAsB,KAAKuL,OAAL,CAAaE,MAFlD,EAGKkC,IAHL,CAGU,WAHV,EAG0B,KAAKpC,OAAL,CAAaW,aAHvC,SAIKyB,IAJL,CAIU,aAJV,EAIyB,KAAKpC,OAAL,CAAaY,iBAJtC,EAKKwB,IALL,CAKU,MALV,EAKkB,KAAKpC,OAAL,CAAaI,SAL/B,EAMKgC,IANL,CAMU,OANV,EAMmB,gCANnB,EAOKC,IAPL,CAOU;AAAA,mBAAK,OAAKrC,OAAL,CAAaU,UAAb,GAA0Bd,EAAE2D,KAA5B,QAAuC3D,EAAElN,KAAF,CAAQyQ,OAAR,CAAgB,OAAKnD,OAAL,CAAaM,QAA7B,CAA5C;AAAA,SAPV;AAQH,KA1HiC;;AA4HlCsC,uBAAmB,6BAAY;AAAA;;AAAA,oCACR,KAAKtN,KADG;AAAA,YACpBiI,GADoB;AAAA,YACfC,GADe;;AAE3B,YAAIgG,QAAQ,CAAChG,MAAMD,GAAP,IAAc,KAAKyC,OAAL,CAAaK,KAAvC;AACA,YAAI9E,OAAO+B,GAAGhI,KAAH,CAASiI,GAAT,EAAcC,MAAMgG,KAApB,EAA2BA,KAA3B,CAAX;AACA,YAAIb,gBAAgBpH,KAAKT,GAAL,CAAS,aAAK;AAC9B,mBAAO;AACHpI,uBAAOkN,CADJ;AAEHkB,uBAAO,OAAKA,KAAL,CAAWlB,CAAX;AAFJ,aAAP;AAIH,SALmB,CAApB;AAMA,eAAO+C,aAAP;AACH,KAvIiC;;AAyIlCU,+BAA2B,qCAAY;AAAA;;AACnC,YAAII,eAAenG,GACdoG,WADc,GAEdpO,KAFc,CAER,CAAC,CAAD,EAAI,KAAK0K,OAAL,CAAaxL,KAAjB,CAFQ,EAGdmP,MAHc,CAGP,KAAKrO,KAHE,CAAnB;AAIA,YAAIiG,OAAO,KAAKyE,OAAL,CAAaS,MAAxB;AACA,YAAImD,mBAAmBrI,KAAKT,GAAL,CAAS,UAAC8E,CAAD,EAAIiE,KAAJ,EAAc;AAC1C,mBAAO;AACHN,uBAAO,OAAKvD,OAAL,CAAaU,UAAb,GAA0B,OAAKV,OAAL,CAAaU,UAAb,CAAwBmD,KAAxB,CAA1B,GAA2D,EAD/D;AAEHnR,uBAAOkN,CAFJ;AAGHK,0BAAUwD,aAAa7D,CAAb;AAHP,aAAP;AAKH,SANsB,CAAvB;AAOA,eAAOgE,gBAAP;AACH;AAvJiC,CAAjB,CAArB;;AA0JA5P,EAAE8P,OAAF,CAAUC,QAAV,GAAqB,UAAUjD,KAAV,EAAiBxL,KAAjB,EAAwB0K,OAAxB,EAAiC;AAClD,WAAO,IAAIhM,EAAE6L,OAAF,CAAUC,QAAd,CAAuBgB,KAAvB,EAA8BxL,KAA9B,EAAqC0K,OAArC,CAAP;AACH,CAFD,C;;;;;;AChKA;;;;AAIAhM,EAAEgQ,WAAF,CAAc5P,KAAd,GAAsBJ,EAAEgQ,WAAF,CAAcjE,MAAd,CAAqB;AACvCC,aAAS;AACLiE,yBAAiB;AACbvR,mBAAO,SADM;AAEbwR,qBAAS;AAFI,SADZ;AAKLC,iBAAS,CALJ;AAMLC,iBAAS,IANJ;AAOLC,qBAAa,IAPR;AAQLC,kBAAU;AARL,KAD8B;;AAYvCzD,gBAAY,oBAAS0D,KAAT,EAAgBvE,OAAhB,EAAyB;AACjChM,UAAE+M,IAAF,CAAOC,UAAP,CAAkB,IAAlB,EAAwBhB,OAAxB;AACA,aAAKwE,QAAL,GAAgB,IAAhB;AACA,YAAID,KAAJ,EAAW;AACP,iBAAKE,OAAL,CAAaF,KAAb;AACH;AACJ,KAlBsC;;AAoBvCG,eAAW,qBAAW;AAClB,YAAIC,SAAS3Q,EAAEgQ,WAAF,CAAcY,SAAd,CAAwBF,SAAxB,CAAkCG,IAAlC,CAAuC,IAAvC,CAAb;AACAF,eAAOG,SAAP,GAAmB,KAAKC,WAAL,CAAiBC,IAAjB,CAAsB,IAAtB,CAAnB;AACAL,eAAOM,OAAP,GAAiB,KAAKC,WAAL,CAAiBF,IAAjB,CAAsB,IAAtB,CAAjB;AACA,eAAOL,MAAP;AACH,KAzBsC;;AA2BvCQ,qBAAiB,2BAAW;AACxB,aAAKC,eAAL;AACA,aAAKC,sBAAL;AACH,KA9BsC;;AAgCvCC,QAhCuC,kBAgChC;AACH,aAAKd,QAAL,GAAgB,IAAhB;AACA,aAAKU,WAAL;AACA,aAAKE,eAAL;AACH,KApCsC;AAsCvCG,QAtCuC,kBAsChC;AACH,aAAKf,QAAL,GAAgB,KAAhB;AACA,aAAKO,WAAL;AACA,aAAKS,gBAAL;AACH,KA1CsC;AA4CvCC,aA5CuC,uBA4C3B;AACR,eAAO,KAAKjB,QAAZ;AACH,KA9CsC;AAgDvCU,eAhDuC,yBAgDzB;AACV,YAAI,KAAKQ,OAAL,IAAgB,KAAKlB,QAAzB,EAAmC;AAC/B,iBAAKkB,OAAL,CAAapE,KAAb,CAAmBqE,UAAnB,GAAgC,SAAhC;AACH;AACJ,KApDsC;AAsDvCZ,eAtDuC,yBAsDzB;AACV,YAAI,KAAKW,OAAT,EAAkB;AACd,iBAAKA,OAAL,CAAapE,KAAb,CAAmBqE,UAAnB,GAAgC,QAAhC;AACH;AACJ,KA1DsC;AA4DvCP,mBA5DuC,6BA4DrB;AACd,aAAKlE,IAAL,CAAU0E,EAAV,CAAa,OAAb,EAAsB,KAAKC,QAA3B,EAAqC,IAArC;AACA,aAAK3E,IAAL,CAAU0E,EAAV,CAAa,WAAb,EAA0B,KAAKE,YAA/B,EAA6C,IAA7C;;AAEA,aAAK9F,OAAL,CAAaoE,OAAb,IAAwB,KAAKwB,EAAL,CAAQ,OAAR,EAAiB,KAAK5F,OAAL,CAAaoE,OAA9B,EAAuC,IAAvC,CAAxB;AACA,aAAKpE,OAAL,CAAaqE,WAAb,IACI,KAAKuB,EAAL,CAAQ,WAAR,EAAqB,KAAK5F,OAAL,CAAaqE,WAAlC,EAA+C,IAA/C,CADJ;AAEH,KAnEsC;AAqEvCmB,oBArEuC,8BAqEpB;AACf,aAAKtE,IAAL,CAAU6E,GAAV,CAAc,OAAd,EAAuB,KAAKF,QAA5B,EAAsC,IAAtC;AACA,aAAK3E,IAAL,CAAU6E,GAAV,CAAc,WAAd,EAA2B,KAAKD,YAAhC,EAA8C,IAA9C;;AAEA,aAAK9F,OAAL,CAAaoE,OAAb,IAAwB,KAAK2B,GAAL,CAAS,OAAT,EAAkB,KAAK/F,OAAL,CAAaoE,OAA/B,EAAwC,IAAxC,CAAxB;AACA,aAAKpE,OAAL,CAAaqE,WAAb,IACI,KAAK0B,GAAL,CAAS,WAAT,EAAsB,KAAK/F,OAAL,CAAaqE,WAAnC,EAAgD,IAAhD,CADJ;AAEH,KA5EsC;AA8EvCgB,0BA9EuC,oCA8Ed;AACrB,YAAIW,UAAU,KAAK9E,IAAL,CAAU+E,0BAAV,CAAqC,CAAC,CAAD,EAAI,CAAJ,CAArC,CAAd;AACAjS,UAAEoN,OAAF,CAAU8E,WAAV,CAAsB,KAAKR,OAA3B,EAAoCM,OAApC;AACH,KAjFsC;;;AAmFvCG,wBAAoB,8BAAW;AAC3B,aAAKX,gBAAL;AACH,KArFsC;;AAuFvCY,cAvFuC,wBAuF1B;AACT,YAAI,KAAKlF,IAAL,IAAa,KAAKmF,MAAtB,EAA8B;AAC1BrS,cAAEgQ,WAAF,CAAcY,SAAd,CAAwBwB,UAAxB,CAAmCvB,IAAnC,CAAwC,IAAxC;AACH;AACJ,KA3FsC;;;AA6FvC;AACAyB,iBAAa,qBAASC,QAAT,EAAmB;AAC5B,cAAM,IAAIlR,SAAJ,CAAc,mBAAd,CAAN;AACH,KAhGsC;AAiGvC;;AAEAoP,aAAS,iBAASF,KAAT,EAAgB;AACrB,aAAKvE,OAAL,CAAasE,QAAb,IAAyBC,MAAMiC,SAAN,CAAgB,KAAKxG,OAAL,CAAasE,QAA7B,CAAzB;AACA,aAAK+B,MAAL,GAAc9B,KAAd;AACA,aAAK6B,UAAL;AACA,aAAKK,IAAL,CAAU,MAAV;AACH,KAxGsC;;AA0GvCD,eAAW,mBAASvQ,CAAT,EAAY;AACnB,aAAK+J,OAAL,CAAasE,QAAb,GAAwBrO,CAAxB;AACA,aAAKoQ,MAAL,IAAe,KAAKA,MAAL,CAAYG,SAAZ,CAAsBvQ,CAAtB,CAAf;AACA,aAAKmQ,UAAL;AACH,KA9GsC;;AAgHvCM,gBAAY,oBAASvC,OAAT,EAAkB;AAC1B,aAAKnE,OAAL,CAAamE,OAAb,GAAuBA,OAAvB;;AAEA,YAAI,KAAKuB,OAAT,EAAkB;AACd,iBAAKiB,cAAL;AACH;AACD,eAAO,IAAP;AACH,KAvHsC;;AAyHvCC,eAAW,qBAAW;AAClB,YAAIC,KAAK,KAAKR,MAAL,CAAYS,MAAZ,EAAT;;AAEA,YAAIC,YAAY/S,EAAEC,MAAF,CAAS4S,GAAG,CAAH,CAAT,EAAgBA,GAAG,CAAH,CAAhB,CAAhB;AAAA,YACIG,YAAYhT,EAAEC,MAAF,CAAS4S,GAAG,CAAH,CAAT,EAAgBA,GAAG,CAAH,CAAhB,CADhB;AAEA,YAAII,SAASjT,EAAEG,YAAF,CAAe4S,SAAf,EAA0BC,SAA1B,CAAb;AACA,eAAOC,MAAP;AACH,KAhIsC;;AAkIvCpB,cAAU,kBAASqB,CAAT,EAAY;AAClB,YAAI1T,IAAI,KAAK2T,WAAL,CAAiBD,CAAjB,CAAR;AACA,aAAKT,IAAL,CAAU,OAAV,EAAmBjT,CAAnB;AACH,KArIsC;;AAuIvCsS,kBAAc,sBAASoB,CAAT,EAAY;AACtB,YAAI1T,IAAI,KAAK2T,WAAL,CAAiBD,CAAjB,CAAR;AACA,aAAKE,eAAL,CAAqB5T,CAArB;AACA,aAAKiT,IAAL,CAAU,WAAV,EAAuBjT,CAAvB;AACH,KA3IsC;;AA6IvC4T,qBAAiB,yBAAS5T,CAAT,EAAY;AACzB,YAAI,CAAC,KAAKwM,OAAL,CAAaiE,eAAlB,EAAmC;;AADV,oCAGA,KAAKjE,OAAL,CAAaiE,eAHb;AAAA,YAGnBvR,KAHmB,yBAGnBA,KAHmB;AAAA,YAGZwR,OAHY,yBAGZA,OAHY;;AAIzB,YAAI5C,QAAQ,KAAKJ,IAAL,CAAUmG,YAAV,GAAyB/F,KAArC;AACAA,cAAMO,MAAN,GAAerO,EAAEd,KAAF,KAAY,IAAZ,GAAmBA,KAAnB,GAA2BwR,OAA1C;AACH,KAnJsC;;AAqJvCyC,oBAAgB,0BAAW;AACvB3S,UAAEoN,OAAF,CAAUsF,UAAV,CAAqB,KAAKhB,OAA1B,EAAmC,KAAK1F,OAAL,CAAamE,OAAhD;AACH,KAvJsC;;AAyJvCgD,iBAAa,qBAASD,CAAT,EAAY;AACrB,YAAI1T,IAAI,KAAK6S,MAAL,GACF,KAAKA,MAAL,CAAY3N,OAAZ,CAAoBwO,EAAEI,MAAF,CAASxT,GAA7B,EAAkCoT,EAAEI,MAAF,CAAS1T,GAA3C,CADE,GAEF,IAFN;AAGA,YAAI2T,SAAS;AACTD,oBAAQJ,EAAEI,MADD;AAET5U,mBAAOc;AAFE,SAAb;AAIA,eAAO+T,MAAP;AACH,KAlKsC;;AAoKvCC,wBAAoB,8BAAW;AAC3B,YAAIC,IAAI,KAAK/B,OAAL,CAAagC,UAAb,CAAwB,IAAxB,CAAR;AACAD,UAAEE,SAAF,CAAY,CAAZ,EAAe,CAAf,EAAkB,KAAKjC,OAAL,CAAalR,KAA/B,EAAsC,KAAKkR,OAAL,CAAajR,MAAnD;AACA,eAAOgT,CAAP;AACH;AAxKsC,CAArB,CAAtB,C;;;;;;;;;;;ACJA;;AAEA;;;AAGAzT,EAAEgQ,WAAF,CAAcvK,WAAd,GAA4BzF,EAAEgQ,WAAF,CAAc5P,KAAd,CAAoB2L,MAApB,CAA2B;AACnDC,aAAS;AACL/M,cAAM,UADD,EACa;AAClB6N,eAAO,IAFF,EAEQ;AACb8G,qBAAa,KAHR,EAGe;AACpBC,oBAAY,EAJP,EAIW;AAChBC,wBAAgB,MALX,CAKkB;AALlB,KAD0C;;AASnDjH,gBAAY,oBAASkH,WAAT,EAAsB/H,OAAtB,EAA+B;AACvChM,UAAEgQ,WAAF,CAAc5P,KAAd,CAAoBwQ,SAApB,CAA8B/D,UAA9B,CAAyCgE,IAAzC,CACI,IADJ,EAEIkD,WAFJ,EAGI/H,OAHJ;AAKAhM,UAAE+M,IAAF,CAAOC,UAAP,CAAkB,IAAlB,EAAwBhB,OAAxB;AACH,KAhBkD;;AAkBnDgI,wBAAoB,8BAAW;AAC3B,eAAOC,OAAOC,KAAP,CAAa,CAAC,OAAD,EAAU,OAAV,CAAb,EAAiCvE,MAAjC,CAAwC,KAAK0C,MAAL,CAAY/Q,KAApD,CAAP;AACH,KApBkD;;AAsBnD6S,YAtBmD,oBAsB1ClS,CAtB0C,EAsBvC;AACR,aAAK+J,OAAL,CAAac,KAAb,GAAqB7K,CAArB;AACA,aAAKmQ,UAAL;AACH,KAzBkD;;;AA2BnD;AACAE,iBAAa,qBAASC,QAAT,EAAmB;AAC5B,YAAI,CAAC,KAAKd,SAAL,EAAL,EAAuB;AACvB,aAAKkB,cAAL;;AAEA,YAAIyB,IAAI,KAAKC,kBAAL,EAAR;AACA;AACAD;AACA;AACH,KApCkD;AAqCnD;;AAEAC,wBAAoB,8BAAW;AAC3B,gBAAQ,KAAKrI,OAAL,CAAa/M,IAArB;AACI,iBAAK,UAAL;AACI,uBAAO,KAAKqV,UAAL,CAAgBtD,IAAhB,CAAqB,IAArB,CAAP;AACJ,iBAAK,QAAL;AACI,uBAAO,KAAKuD,WAAL,CAAiBvD,IAAjB,CAAsB,IAAtB,CAAP;AACJ;AACI,sBAAM1J,kCAAgC,KAAK0E,OAAL,CAAa/M,IAA7C,CAAN;AANR;AAQH,KAhDkD;;AAkDnDuV,kBAAc,wBAAW;AACrB,YAAI,KAAKxI,OAAL,CAAac,KAAb,KAAuB,IAA3B,EAAiC;AAC7B,iBAAKqH,QAAL,CAAc,KAAKH,kBAAL,EAAd;AACH;AACJ,KAtDkD;;AAwDnD9C,eAxDmD,yBAwDrC;AACVlR,UAAEgQ,WAAF,CAAc5P,KAAd,CAAoBwQ,SAApB,CAA8BM,WAA9B,CAA0CL,IAA1C,CAA+C,IAA/C;AACA,aAAKuB,UAAL,GAFU,CAES;AACtB,KA3DkD;;;AA6DnD;;;;AAIAkC,gBAAY,sBAAW;AACnB,aAAKE,YAAL;;AAEA,YAAIC,MAAM,KAAKjB,kBAAL,EAAV;AACA,YAAIhT,QAAQ,KAAKkR,OAAL,CAAalR,KAAzB;AACA,YAAIC,SAAS,KAAKiR,OAAL,CAAajR,MAA1B;;AAEA,YAAIiU,MAAMD,IAAIE,eAAJ,CAAoBnU,KAApB,EAA2BC,MAA3B,CAAV;AACA,YAAI8G,OAAOmN,IAAInN,IAAf;;AAEA,aAAKqN,eAAL,CAAqBrN,IAArB,EAA2B/G,KAA3B,EAAkCC,MAAlC;AACAgU,YAAII,YAAJ,CAAiBH,GAAjB,EAAsB,CAAtB,EAAyB,CAAzB;AACH,KA7EkD;;AA+EnD;;;;;;;;AAQAE,mBAvFmD,2BAuFnCrN,IAvFmC,EAuF7B/G,KAvF6B,EAuFtBC,MAvFsB,EAuFd;AACjC,YAAIwB,IAAI,KAAK+J,OAAL,CAAa4H,WAAb,GAA2B,qBAA3B,GAAmD,SAA3D;;AAEA,YAAIkB,MAAM,CAAV;AACA,aAAK,IAAIpT,IAAI,CAAb,EAAgBA,IAAIjB,MAApB,EAA4BiB,GAA5B,EAAiC;AAC7B,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAInB,KAApB,EAA2BmB,GAA3B,EAAgC;AAC5B,oBAAIoT,cAAc,KAAK7H,IAAL,CAAU8H,sBAAV,CAAiC,CAACrT,CAAD,EAAID,CAAJ,CAAjC,CAAlB;AACA,oBAAIG,MAAMkT,YAAYjV,GAAtB;AACA,oBAAIF,MAAMmV,YAAYnV,GAAtB;;AAEA,oBAAIJ,IAAI,KAAK6S,MAAL,CAAYpQ,CAAZ,EAAeJ,GAAf,EAAoBjC,GAApB,CAAR,CAL4B,CAKM;AAClC,oBAAIJ,MAAM,IAAV,EAAgB;AACZ,wBAAIsN,QAAQ,KAAKmI,YAAL,CAAkBzV,CAAlB,CAAZ;;AADY,sCAEOsN,MAAMoI,IAAN,EAFP;AAAA;AAAA,wBAEPC,CAFO;AAAA,wBAEJC,CAFI;AAAA,wBAEDC,CAFC;AAAA,wBAEEC,CAFF;;AAGZ/N,yBAAKuN,GAAL,IAAYK,CAAZ;AACA5N,yBAAKuN,MAAM,CAAX,IAAgBM,CAAhB;AACA7N,yBAAKuN,MAAM,CAAX,IAAgBO,CAAhB;AACA9N,yBAAKuN,MAAM,CAAX,IAAgB1N,SAASkO,IAAI,GAAb,CAAhB,CANY,CAMuB;AACtC;AACDR,sBAAMA,MAAM,CAAZ;AACH;AACJ;AACJ,KA7GkD;;;AA+GnD;;;AAGAP,iBAAa,uBAAW;AACpB,YAAMtB,SAAS,KAAKsC,YAAL,EAAf;AACA,YAAMC,YAAY,CAACvC,OAAOzJ,GAAP,CAAWxE,CAAX,GAAeiO,OAAO1J,GAAP,CAAWvE,CAA3B,IAAgC,KAAKqN,MAAL,CAAY/R,KAA9D;;AAEA,YAAIkB,SAAS0C,KAAKsF,GAAL,CACT,CADS,EAETtF,KAAKC,KAAL,CAAW,MAAM,KAAK6H,OAAL,CAAa6H,UAAnB,GAAgC2B,SAA3C,CAFS,CAAb;;AAKA,YAAMf,MAAM,KAAKjB,kBAAL,EAAZ;AACAiB,YAAIgB,WAAJ,GAAkB,KAAKzJ,OAAL,CAAac,KAA/B;;AAEA,YAAI4I,gBAAgB,KAAKxI,IAAL,CAAU0F,SAAV,EAApB;;AAEA,aAAK,IAAI1N,IAAI,CAAb,EAAgBA,IAAI,KAAKmN,MAAL,CAAY5R,MAAhC,EAAwCyE,IAAIA,IAAI1D,MAAhD,EAAwD;AACpD,iBAAK,IAAIwD,IAAI,CAAb,EAAgBA,IAAI,KAAKqN,MAAL,CAAY7R,KAAhC,EAAuCwE,IAAIA,IAAIxD,MAA/C,EAAuD;AAAA,4CAClC,KAAK6Q,MAAL,CAAYzQ,gBAAZ,CAA6BoD,CAA7B,EAAgCE,CAAhC,CADkC;AAAA;AAAA,oBAC9CrD,GAD8C;AAAA,oBACzCjC,GADyC;;AAEnD,oBAAIJ,IAAI,KAAK6S,MAAL,CAAY3N,OAAZ,CAAoB7C,GAApB,EAAyBjC,GAAzB,CAAR;AACA,oBAAInB,SAASuB,EAAEC,MAAF,CAASL,GAAT,EAAciC,GAAd,CAAb;AACA,oBAAIrC,MAAM,IAAN,IAAckW,cAAczS,QAAd,CAAuBxE,MAAvB,CAAlB,EAAkD;AAC9C,wBAAIkX,OAAO,IAAI,sDAAJ,CACPlX,MADO,EAEPe,CAFO,EAGP,KAAKsB,SAHE,EAIP,KAAKC,SAJE,CAAX;AAMA,yBAAK6U,UAAL,CAAgBD,IAAhB,EAAsBlB,GAAtB;AACH;AACJ;AACJ;AACJ,KAhJkD;;AAkJnDc,kBAAc,wBAAW;AACrB,YAAMtC,SAAS,KAAKL,SAAL,EAAf;AACA,YAAMiD,YAAY,KAAK3I,IAAL,CAAU4I,sBAAV,CACd7C,OAAO8C,YAAP,EADc,CAAlB;AAGA,YAAMC,YAAY,KAAK9I,IAAL,CAAU4I,sBAAV,CACd7C,OAAOgD,YAAP,EADc,CAAlB;AAGA,YAAIC,cAAclW,EAAEiT,MAAF,CAAS4C,SAAT,EAAoBG,SAApB,CAAlB;AACA,eAAOE,WAAP;AACH,KA5JkD;;AA8JnDN,gBAAY,oBAASD,IAAT,EAAelB,GAAf,EAAoB;AAC5B,YAAI0B,YAAY,KAAKjJ,IAAL,CAAU4I,sBAAV,CAAiCH,KAAKlX,MAAtC,CAAhB;;AAEA;AACA,YAAIqO,QAAQ,KAAKd,OAAL,CAAac,KAAzB;AACA,YAAI,OAAOA,KAAP,KAAiB,UAArB,EAAiC;AAC7B2H,gBAAIgB,WAAJ,GAAkB3I,MAAM6I,KAAKjX,KAAX,CAAlB;AACH;;AAED,YAAM0X,OAAO,KAAKpK,OAAL,CAAa6H,UAA1B;AACAY,YAAI4B,IAAJ;;AAEA5B,YAAI6B,SAAJ,CAAcH,UAAUnR,CAAxB,EAA2BmR,UAAUjR,CAArC;;AAEA,YAAIqR,eAAe,CAAC,KAAKZ,KAAKjX,KAAX,IAAoBwF,KAAK6F,EAAzB,GAA8B,GAAjD,CAd4B,CAc0B;AACtD,YAAI,KAAKiC,OAAL,CAAa8H,cAAb,KAAgC,SAApC,EAA+C;AAC3CyC,2BAAeA,eAAerS,KAAK6F,EAAnC;AACH;AACD0K,YAAI+B,MAAJ,CAAWD,YAAX;;AAEA9B,YAAIgC,SAAJ;AACAhC,YAAIiC,MAAJ,CAAW,CAACN,IAAD,GAAQ,CAAnB,EAAsB,CAAtB;AACA3B,YAAIkC,MAAJ,CAAW,CAACP,IAAD,GAAQ,CAAnB,EAAsB,CAAtB;AACA3B,YAAIiC,MAAJ,CAAWN,OAAO,IAAlB,EAAwB,CAACA,IAAD,GAAQ,IAAhC;AACA3B,YAAIkC,MAAJ,CAAW,CAACP,IAAD,GAAQ,CAAnB,EAAsB,CAAtB;AACA3B,YAAIkC,MAAJ,CAAWP,OAAO,IAAlB,EAAwBA,OAAO,IAA/B;AACA3B,YAAImC,MAAJ;AACAnC,YAAIoC,OAAJ;AACH,KA1LkD;;AA4LnD;;;AAGA5B,gBA/LmD,wBA+LtCzV,CA/LsC,EA+LnC;AACZ,YAAIuC,IAAI,KAAKiK,OAAL,CAAac,KAArB,CADY,CACgB;AAC5B,YAAI,OAAO/K,CAAP,KAAa,UAAjB,EAA6B;AACzBA,gBAAI,KAAKiK,OAAL,CAAac,KAAb,CAAmBtN,CAAnB,CAAJ;AACH;AACD,YAAIsN,QAAQmH,OAAOlS,CAAP,CAAZ,CALY,CAKW;AACvB,eAAO+K,KAAP;AACH;AAtMkD,CAA3B,CAA5B;;AAyMA9M,EAAE8W,WAAF,CAAc/C,WAAd,GAA4B,UAASA,WAAT,EAAsB/H,OAAtB,EAA+B;AACvD,WAAO,IAAIhM,EAAEgQ,WAAF,CAAcvK,WAAlB,CAA8BsO,WAA9B,EAA2C/H,OAA3C,CAAP;AACH,CAFD,C;;;;;;;;AC9MA;;;;;AAKAhM,EAAEgQ,WAAF,CAAc+G,YAAd,GAA6B/W,EAAEgQ,WAAF,CAAcjE,MAAd,CAAqB;AAC9CC,aAAS;AACLc,eAAO,MADF;AAELsJ,cAAM;AAFD,KADqC;;AAM9CvJ,gBAAY,oBAASmK,MAAT,EAAiBhL,OAAjB,EAA0B;AAClC,aAAKgL,MAAL,GAAcA,MAAd;AACAhX,UAAE+M,IAAF,CAAOC,UAAP,CAAkB,IAAlB,EAAwBhB,OAAxB;AACH,KAT6C;;AAW9CmF,qBAAiB,2BAAW;AACxB;AACH,KAb6C;;AAe9CgB,wBAAoB,8BAAW;AAC3B;AACH,KAjB6C;;AAmB9C;AACA1B,aAAS,iBAASlJ,IAAT,EAAe;AACpB;AACA,aAAK6K,UAAL,GAFoB,CAED;AACtB,KAvB6C;AAwB9C;;AAEAE,iBAAa,qBAASC,QAAT,EAAmB;AAC5B;AACA,YAAIkB,IAAIlB,SAAS0E,MAAT,CAAgBvD,UAAhB,CAA2B,IAA3B,CAAR;AACAD,UAAEE,SAAF,CAAY,CAAZ,EAAe,CAAf,EAAkBpB,SAAS0E,MAAT,CAAgBzW,KAAlC,EAAyC+R,SAAS0E,MAAT,CAAgBxW,MAAzD;AACAgT,UAAEyD,SAAF,GAAc,KAAKlL,OAAL,CAAac,KAA3B;;AAJ4B;AAAA;AAAA;;AAAA;AAM5B,iCAAkB,KAAKkK,MAAvB,8HAA+B;AAAA,oBAAtBG,KAAsB;;AAC3B,oBAAIxQ,IAAI4L,SAAS6E,KAAT,CAAelK,IAAf,CAAoB4I,sBAApB,CAA2CqB,KAA3C,CAAR;AACA1D,kBAAEgD,SAAF;AACA;AACAhD,kBAAE4D,QAAF,CAAW1Q,EAAE3B,CAAb,EAAgB2B,EAAEzB,CAAlB,EAAqB,KAAK8G,OAAL,CAAaoK,IAAlC,EAAwC,KAAKpK,OAAL,CAAaoK,IAArD,EAJ2B,CAIiC;AAC5D3C,kBAAE6D,IAAF;AACA7D,kBAAE8D,SAAF;AACA9D,kBAAEmD,MAAF;AACH;AAd2B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAe/B,KAzC6C;;AA2C9ChE,eAAW,qBAAW;AAClB;AACA,YAAI4E,KAAK,KAAKR,MAAL,CAAYlQ,GAAZ,CAAgB;AAAA,mBAAMnE,GAAG7C,GAAT;AAAA,SAAhB,CAAT;AACA,YAAI2X,KAAK,KAAKT,MAAL,CAAYlQ,GAAZ,CAAgB;AAAA,mBAAMnE,GAAG/C,GAAT;AAAA,SAAhB,CAAT;;AAEA,YAAIyC,OAAO6B,KAAKqF,GAAL,gCAAYiO,EAAZ,EAAX;AACA,YAAIE,OAAOxT,KAAKqF,GAAL,gCAAYkO,EAAZ,EAAX;AACA,YAAInV,OAAO4B,KAAKsF,GAAL,gCAAYgO,EAAZ,EAAX;AACA,YAAIG,OAAOzT,KAAKsF,GAAL,gCAAYiO,EAAZ,EAAX;;AAEA,YAAI1E,YAAY/S,EAAEC,MAAF,CAASyX,IAAT,EAAerV,IAAf,CAAhB;AAAA,YACI2Q,YAAYhT,EAAEC,MAAF,CAAS0X,IAAT,EAAerV,IAAf,CADhB;AAEA,YAAI2Q,SAASjT,EAAEG,YAAF,CAAe4S,SAAf,EAA0BC,SAA1B,CAAb,CAZkB,CAYiC;AACnD,eAAOC,MAAP;AACH;AAzD6C,CAArB,CAA7B;;AA4DAjT,EAAE8W,WAAF,CAAcc,YAAd,GAA6B,UAASC,QAAT,EAAmB7L,OAAnB,EAA4B;AACrD,WAAO,IAAIhM,EAAEgQ,WAAF,CAAc+G,YAAlB,CAA+Bc,QAA/B,EAAyC7L,OAAzC,CAAP;AACH,CAFD,C;;;;;;ACjEA;;;AAGAhM,EAAEgQ,WAAF,CAAc8H,eAAd,GAAgC9X,EAAEgQ,WAAF,CAAc5P,KAAd,CAAoB2L,MAApB,CAA2B;AACvDC,aAAS;AACL+L,eAAO,GADF;AAELjL,eAAO,OAFF,EAEW;AAChBtM,eAAO,GAHF,EAGO;AACZwX,cAAM,IAJD,EAIO;AACZC,kBAAU,EALL,EAKS;AACdC,gBAAQ,GANH,EAMQ;AACbC,uBAAe,IAAI;AAPd,KAD8C;;AAWvDtL,gBAAY,oBAASuL,WAAT,EAAsBpM,OAAtB,EAA+B;AACvChM,UAAEgQ,WAAF,CAAc5P,KAAd,CAAoBwQ,SAApB,CAA8B/D,UAA9B,CAAyCgE,IAAzC,CACI,IADJ,EAEIuH,WAFJ,EAGIpM,OAHJ;AAKAhM,UAAE+M,IAAF,CAAOC,UAAP,CAAkB,IAAlB,EAAwBhB,OAAxB;;AAEA,aAAKqM,KAAL,GAAa,IAAb;AACH,KApBsD;;AAsBvDlH,qBAAiB,2BAAW;AACxBnR,UAAEgQ,WAAF,CAAc5P,KAAd,CAAoBwQ,SAApB,CAA8BO,eAA9B,CAA8CN,IAA9C,CAAmD,IAAnD;AACA,aAAK3D,IAAL,CAAU0E,EAAV,CAAa,aAAb,EAA4B,KAAK0G,cAAjC,EAAiD,IAAjD;AACH,KAzBsD;;AA2BvDnG,wBAAoB,8BAAW;AAC3BnS,UAAEgQ,WAAF,CAAc5P,KAAd,CAAoBwQ,SAApB,CAA8BuB,kBAA9B,CAAiDtB,IAAjD,CAAsD,IAAtD;AACA,aAAK3D,IAAL,CAAU6E,GAAV,CAAc,aAAd,EAA6B,KAAKuG,cAAlC,EAAkD,IAAlD;AACA,aAAKA,cAAL;AACH,KA/BsD;;AAiCvDvH,iBAAa,SAASG,WAAT,GAAuB;AAChClR,UAAEgQ,WAAF,CAAc5P,KAAd,CAAoBwQ,SAApB,CAA8BG,WAA9B,CAA0CF,IAA1C,CAA+C,IAA/C;AACA,aAAKyH,cAAL;AACH,KApCsD;;AAsCvDhG,iBAAa,qBAASC,QAAT,EAAmB;AAC5B,YAAI,CAAC,KAAKF,MAAN,IAAgB,CAAC,KAAKZ,SAAL,EAArB,EAAuC;;AAEvC,aAAKkB,cAAL;;AAEA,YAAI8B,MAAM,KAAKjB,kBAAL,EAAV;AACA,YAAIuE,QAAQ,KAAKQ,qBAAL,EAAZ;;AAEA,aAAKF,KAAL,GAAa/O,GAAG+O,KAAH,CAAS,YAAW;AAC7BG;AACAC;AACH,SAHY,EAGV,KAAKzM,OAAL,CAAaiM,QAHH,CAAb;;AAKA,YAAIS,OAAO,IAAX;;AAEA;;;;AAIA,iBAASF,cAAT,GAA0B;AACtB;AACAT,kBAAMzR,OAAN,CAAc,UAASqS,GAAT,EAAc;AACxB,oBAAIA,IAAIC,GAAJ,GAAUF,KAAK1M,OAAL,CAAakM,MAA3B,EAAmC;AAC/B;AACAS,wBAAIC,GAAJ,GAAU,CAAV;AACAF,yBAAKrG,MAAL,CAAYwG,cAAZ,CAA2BF,GAA3B;AACH;;AAED,oBAAIG,SAASJ,KAAKrG,MAAL,CAAY3N,OAAZ,CAAoBiU,IAAI3T,CAAxB,EAA2B2T,IAAIzT,CAA/B,CAAb;AACA,oBAAI4T,WAAW,IAAf,EAAqB;AACjBH,wBAAIC,GAAJ,GAAUF,KAAK1M,OAAL,CAAakM,MAAvB;AACH,iBAFD,MAEO;AACH;AACA,wBAAIa,KAAKJ,IAAI3T,CAAJ,GAAQ8T,OAAOvZ,CAAP,GAAWmZ,KAAK1M,OAAL,CAAamM,aAAzC,CAFG,CAEqD;AACxD,wBAAIa,KAAKL,IAAIzT,CAAJ,GAAQ4T,OAAOtZ,CAAP,GAAWkZ,KAAK1M,OAAL,CAAamM,aAAzC,CAHG,CAGqD;;AAExD,wBAAIO,KAAKrG,MAAL,CAAYxN,UAAZ,CAAuBkU,EAAvB,EAA2BC,EAA3B,CAAJ,EAAoC;AAChCL,4BAAII,EAAJ,GAASA,EAAT;AACAJ,4BAAIK,EAAJ,GAASA,EAAT;AACAL,4BAAIxW,CAAJ,GAAQ2W,OAAOpN,SAAP,EAAR;AACH,qBAJD,MAIO;AACH;AACAiN,4BAAIC,GAAJ,GAAUF,KAAK1M,OAAL,CAAakM,MAAvB;AACH;AACJ;AACDS,oBAAIC,GAAJ,IAAW,CAAX;AACH,aAzBD;AA0BH;;AAED;;;AAGA,iBAASH,cAAT,GAA0B;AACtB;AACA,gBAAIQ,OAAOxE,IAAIyE,wBAAf;AACAzE,gBAAIyE,wBAAJ,GAA+B,gBAA/B;AACAzE,gBAAI4C,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmB5C,IAAIwC,MAAJ,CAAWzW,KAA9B,EAAqCiU,IAAIwC,MAAJ,CAAWxW,MAAhD;AACA;AACAgU,gBAAIyE,wBAAJ,GAA+BD,IAA/B;;AAEA;AACAxE,gBAAIyC,SAAJ,sBAAiCwB,KAAK1M,OAAL,CAAagM,IAA9C;AACAvD,gBAAI0E,SAAJ,GAAgBT,KAAK1M,OAAL,CAAaxL,KAA7B;AACAiU,gBAAIgB,WAAJ,GAAkBiD,KAAK1M,OAAL,CAAac,KAA/B;;AAEA;AACAiL,kBAAMzR,OAAN,CAAc,UAASqS,GAAT,EAAc;AACxBD,qBAAKU,aAAL,CAAmB7G,QAAnB,EAA6BkC,GAA7B,EAAkCkE,GAAlC;AACH,aAFD;AAGH;AACJ,KA5GsD;;AA8GvDS,iBA9GuD,yBA8GzC7G,QA9GyC,EA8G/BkC,GA9G+B,EA8G1BkE,GA9G0B,EA8GrB;AAC9B,YAAIU,SAAS,IAAIrZ,EAAEC,MAAN,CAAa0Y,IAAIzT,CAAjB,EAAoByT,IAAI3T,CAAxB,CAAb;AACA,YAAIsU,SAAS,IAAItZ,EAAEC,MAAN,CAAa0Y,IAAIK,EAAjB,EAAqBL,IAAII,EAAzB,CAAb;;AAEA,YACIxG,SAASU,MAAT,CAAgBhQ,QAAhB,CAAyBoW,MAAzB,KACAV,IAAIC,GAAJ,IAAW,KAAK5M,OAAL,CAAakM,MAF5B,EAGE;AACE,gBAAIqB,KAAKhH,SAAS6E,KAAT,CAAelK,IAAf,CAAoB4I,sBAApB,CAA2CuD,MAA3C,CAAT;AACA,gBAAIG,KAAKjH,SAAS6E,KAAT,CAAelK,IAAf,CAAoB4I,sBAApB,CAA2CwD,MAA3C,CAAT;;AAEA7E,gBAAIgC,SAAJ;AACAhC,gBAAIiC,MAAJ,CAAW6C,GAAGvU,CAAd,EAAiBuU,GAAGrU,CAApB;AACAuP,gBAAIkC,MAAJ,CAAW6C,GAAGxU,CAAd,EAAiBwU,GAAGtU,CAApB;;AAEA;AACAyT,gBAAI3T,CAAJ,GAAQ2T,IAAII,EAAZ;AACAJ,gBAAIzT,CAAJ,GAAQyT,IAAIK,EAAZ;;AAEA;AACA,gBAAIlM,QAAQ,KAAKd,OAAL,CAAac,KAAzB;AACA,gBAAI,OAAOA,KAAP,KAAiB,UAArB,EAAiC;AAC7B2H,oBAAIgB,WAAJ,GAAkB3I,MAAM6L,IAAIxW,CAAV,CAAlB;AACH;;AAED,gBAAI3B,QAAQ,KAAKwL,OAAL,CAAaxL,KAAzB;AACA,gBAAI,OAAOA,KAAP,KAAiB,UAArB,EAAiC;AAC7BiU,oBAAI0E,SAAJ,GAAgB3Y,MAAMmY,IAAIxW,CAAV,CAAhB;AACH;;AAEDsS,gBAAImC,MAAJ;AACH;AACJ,KA9IsD;;;AAgJvD2B,2BAAuB,iCAAW;AAC9B,YAAIR,QAAQ,EAAZ;;AAEA,aAAK,IAAIpW,IAAI,CAAb,EAAgBA,IAAI,KAAKqK,OAAL,CAAa+L,KAAjC,EAAwCpW,GAAxC,EAA6C;AACzC,gBAAIgF,IAAI,KAAK0L,MAAL,CAAYwG,cAAZ,EAAR;AACAlS,cAAEiS,GAAF,GAAQ,KAAKa,UAAL,EAAR;AACA1B,kBAAM/V,IAAN,CAAW2E,CAAX;AACH;AACD,eAAOoR,KAAP;AACH,KAzJsD;;AA2JvD0B,gBAAY,sBAAW;AACnB,eAAOvV,KAAKC,KAAL,CAAWD,KAAKa,MAAL,KAAgB,KAAKiH,OAAL,CAAakM,MAAxC,CAAP;AACH,KA7JsD;;AA+JvDI,oBAAgB,0BAAW;AACvB,YAAI,KAAKD,KAAT,EAAgB;AACZ,iBAAKA,KAAL,CAAWqB,IAAX;AACH;AACJ;AAnKsD,CAA3B,CAAhC;;AAsKA1Z,EAAE8W,WAAF,CAAc6C,eAAd,GAAgC,UAASvB,WAAT,EAAsBpM,OAAtB,EAA+B;AAC3D,WAAO,IAAIhM,EAAEgQ,WAAF,CAAc8H,eAAlB,CAAkCM,WAAlC,EAA+CpM,OAA/C,CAAP;AACH,CAFD,C;;;;;;ACzKA;;;;;;;;AAQAhM,EAAEgQ,WAAF,GAAgBhQ,EAAE4Z,KAAF,CAAQ7N,MAAR,CAAe;AAC3B;AACAc,gBAAY,oBAAUb,OAAV,EAAmB;AAC3B,aAAKkB,IAAL,GAAY,IAAZ;AACA,aAAKwE,OAAL,GAAe,IAAf;AACA,aAAKmI,MAAL,GAAc,IAAd;AACA,aAAKC,SAAL,GAAiB,IAAjB;AACA9Z,UAAEgN,UAAF,CAAa,IAAb,EAAmBhB,OAAnB;AACH,KAR0B;;AAU3B+N,cAAU,kBAAUC,GAAV,EAAe;AACrB,aAAKF,SAAL,GAAiBE,GAAjB;AACA,eAAO,IAAP;AACH,KAb0B;;AAe3B5H,gBAAY,sBAAY;AACpB,YAAI,CAAC,KAAKyH,MAAV,EAAkB;AACd,iBAAKA,MAAL,GAAc7Z,EAAE+M,IAAF,CAAOkN,gBAAP,CAAwB,KAAKC,SAA7B,EAAwC,IAAxC,CAAd;AACH;AACD,eAAO,IAAP;AACH,KApB0B;;AAsB3B;AACAC,uBAAmB,2BAAUC,WAAV,EAAuB;AACtC,aAAK1I,OAAL,CAAalR,KAAb,GAAqB4Z,YAAYC,OAAZ,CAAoBrV,CAAzC;AACA,aAAK0M,OAAL,CAAajR,MAAb,GAAsB2Z,YAAYC,OAAZ,CAAoBnV,CAA1C;AACH,KA1B0B;AA2B3B;AACAoV,qBAAiB,2BAAY;AACzB,YAAItI,UAAU,KAAK9E,IAAL,CAAU+E,0BAAV,CAAqC,CAAC,CAAD,EAAI,CAAJ,CAArC,CAAd;AACAjS,UAAEoN,OAAF,CAAU8E,WAAV,CAAsB,KAAKR,OAA3B,EAAoCM,OAApC;AACA,aAAKkI,SAAL;AACH,KAhC0B;AAiC3B;AACAxJ,eAAW,qBAAY;AACnB,YAAIC,SAAS;AACT4J,oBAAQ,KAAKJ,iBADJ;AAETK,qBAAS,KAAKF;AAFL,SAAb;AAIA,YAAI,KAAKpN,IAAL,CAAUlB,OAAV,CAAkByO,aAAlB,IAAmCza,EAAE0a,OAAF,CAAUC,KAAjD,EAAwD;AACpDhK,mBAAOiK,QAAP,GAAkB,KAAKC,YAAvB;AACH;;AAED,eAAOlK,MAAP;AACH,KA5C0B;AA6C3B;AACA1D,WAAO,eAAUnG,GAAV,EAAe;AAClB,aAAKoG,IAAL,GAAYpG,GAAZ;AACA,aAAK4K,OAAL,GAAe1R,EAAEoN,OAAF,CAAUC,MAAV,CAAiB,QAAjB,EAA2B,eAA3B,CAAf;AACA,aAAKyN,KAAL,GAAa,EAAb;;AAEA,YAAI1E,OAAO,KAAKlJ,IAAL,CAAU6N,OAAV,EAAX;AACA,aAAKrJ,OAAL,CAAalR,KAAb,GAAqB4V,KAAKpR,CAA1B;AACA,aAAK0M,OAAL,CAAajR,MAAb,GAAsB2V,KAAKlR,CAA3B;;AAEA,YAAI8V,WAAW,KAAK9N,IAAL,CAAUlB,OAAV,CAAkByO,aAAlB,IAAmCza,EAAE0a,OAAF,CAAUC,KAA5D;AACA3a,UAAEoN,OAAF,CAAU6N,QAAV,CAAmB,KAAKvJ,OAAxB,EAAiC,mBAAmBsJ,WAAW,UAAX,GAAwB,MAA3C,CAAjC;;AAGAlU,YAAIoU,MAAJ,CAAWC,WAAX,CAAuBC,WAAvB,CAAmC,KAAK1J,OAAxC;;AAEA5K,YAAI8K,EAAJ,CAAO,KAAKlB,SAAL,EAAP,EAAyB,IAAzB;;AAEA,YAAIsJ,MAAM,KAAKF,SAAL,IAAkB,IAA5B;AACAE,YAAI7I,eAAJ,IAAuB6I,IAAI7I,eAAJ,EAAvB,CAlBkB,CAkB4B;;AAE9C,aAAKiB,UAAL;AACH,KAnE0B;;AAqE3B;AACAiJ,cAAU,kBAAUvU,GAAV,EAAe;AACrB,YAAIkT,MAAM,KAAKF,SAAL,IAAkB,IAA5B;AACAE,YAAI7H,kBAAJ,IAA0B6H,IAAI7H,kBAAJ,EAA1B,CAFqB,CAE+B;;;AAGpDrL,YAAIwU,QAAJ,GAAeH,WAAf,CAA2BI,WAA3B,CAAuC,KAAK7J,OAA5C;;AAEA5K,YAAIiL,GAAJ,CAAQ,KAAKrB,SAAL,EAAR,EAA0B,IAA1B;;AAEA,aAAKgB,OAAL,GAAe,IAAf;AAEH,KAjF0B;;AAmF3B;AACA8J,WAAO,eAAU1U,GAAV,EAAe;AAClBA,YAAI2U,QAAJ,CAAa,IAAb;AACA,eAAO,IAAP;AACH,KAvF0B;AAwF3B;AACAC,sBAAkB,0BAAUC,MAAV,EAAkB;AAChC,eAAO;AACH3W,eAAG2W,OAAO7b,GAAP,GAAa,OAAb,GAAuBoE,KAAK6F,EAA5B,GAAiC,GADjC;AAEH7E,eAAGhB,KAAK0X,GAAL,CAAS1X,KAAK2X,GAAL,CAAS,CAAC,KAAKF,OAAO/b,GAAb,IAAoBsE,KAAK6F,EAAzB,GAA8B,GAAvC,CAAT,IAAwD;AAFxD,SAAP;AAIH,KA9F0B;;AAgG3B;AACAmQ,eAAW,qBAAY;AACnB;AACA,YAAI9D,OAAO,KAAKlJ,IAAL,CAAU6N,OAAV,EAAX;AACA,YAAI9H,SAAS,KAAK/F,IAAL,CAAU0F,SAAV,EAAb;AACA,YAAIkJ,OAAO,KAAK5O,IAAL,CAAU6O,OAAV,EAAX;;AAEA,YAAItd,SAAS,KAAKid,gBAAL,CAAsB,KAAKxO,IAAL,CAAU8O,SAAV,EAAtB,CAAb;AACA,YAAIC,SAAS,KAAKP,gBAAL,CAAsB,KAAKxO,IAAL,CAAU8H,sBAAV,CAAiC,KAAK9H,IAAL,CAAU6N,OAAV,EAAjC,CAAtB,CAAb;;AAEA,YAAIf,MAAM,KAAKF,SAAL,IAAkB,IAA5B;AACAE,YAAI1H,WAAJ,IAAmB0H,IAAI1H,WAAJ,CAAgB;AAC/B8E,mBAAO,IADwB;AAE/BH,oBAAQ,KAAKvF,OAFkB;AAG/BuB,oBAAQA,MAHuB;AAI/BmD,kBAAMA,IAJyB;AAK/B0F,kBAAMA,IALyB;AAM/Brd,oBAAQA,MANuB;AAO/Bwd,oBAAQA;AAPuB,SAAhB,CAAnB;AASA,aAAKpC,MAAL,GAAc,IAAd;AACH,KArH0B;;AAuH3B;AACAgB,kBAAc,sBAAU3H,CAAV,EAAa;AACvB,YAAIgB,QAAQ,KAAKhH,IAAL,CAAUgP,YAAV,CAAuBhJ,EAAE4I,IAAzB,CAAZ;AACA,YAAIK,SAAS,KAAKjP,IAAL,CAAUkP,sBAAV,CAAiC,KAAKlP,IAAL,CAAU0F,SAAV,GAAsBmD,YAAtB,EAAjC,EAAuE7C,EAAE4I,IAAzE,EAA+E5I,EAAEzU,MAAjF,CAAb;;AAEAuB,UAAEoN,OAAF,CAAUiP,YAAV,CAAuB,KAAK3K,OAA5B,EAAqCyK,MAArC,EAA6CjI,KAA7C;AACH;AA7H0B,CAAf,CAAhB;;AAgIAlU,EAAE8W,WAAF,GAAgB,YAAY;AACxB,WAAO,IAAI9W,EAAEgQ,WAAN,EAAP;AACH,CAFD,C;;;;;;ACxIA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,YAAY,YAAY,QAAQ,cAAc,KAAK,mBAAmB;AACtE;AACA;AACA;AACA,WAAW,eAAe;AAC1B,WAAW,8BAA8B;AACzC,WAAW,QAAQ;AACnB,aAAa,QAAQ,2CAA2C;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,uCAAuC,iCAAiC;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,WAAW,wBAAwB;AACnC,WAAW,QAAQ;AACnB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA,wCAAwC,iBAAiB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,WAAW,iCAAiC;AAC5C,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACvGA;AACA;AACA;AACA;AACA,WAAW,6CAA6C;AACxD,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,+BAA+B;AAC1C,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;AACL;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,YAAY,MAAM;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,wCAAwC,cAAc;AACtD,yBAAyB,kBAAkB;AAC3C;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,YAAY,MAAM;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wCAAwC,wBAAwB;AAChE,yBAAyB,kBAAkB;AAC3C;AACA;AACA,WAAW,kBAAkB;AAC7B,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,YAAY,MAAM;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,uCAAuC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,aAAa,cAAc;AAC3B,YAAY,MAAM;AAClB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,aAAa,OAAO;AACpB,YAAY,MAAM;AAClB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC9MA;AAAA;AACA;AACAsM,OAAOtc,CAAP,CAASV,MAAT,GAAkB,2DAAlB;;AAEA;AACAgd,OAAOtc,CAAP,CAASxB,IAAT,GAAgB,yDAAhB;;AAEA;AACA8d,OAAOtc,CAAP,CAASI,KAAT,GAAiB,0DAAjB;;AAEA;AACAkc,OAAOtc,CAAP,CAASyF,WAAT,GAAuB,gEAAvB;;AAEA;AACA6W,OAAOtc,CAAP,CAASmK,WAAT,GAAuB,gEAAvB;;AAEA;AACA,mBAAAoS,CAAQ,EAAR;AACA,mBAAAA,CAAQ,CAAR;AACA,mBAAAA,CAAQ,CAAR;AACA,mBAAAA,CAAQ,CAAR;AACA,mBAAAA,CAAQ,CAAR;;AAEA;AACA,mBAAAA,CAAQ,CAAR,E","file":"leaflet.canvaslayer.field.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 989fdb83080b847231b3","/**\n *  Simple regular cell in a raster\n */\nexport default class Cell {\n    /**\n     * A simple cell with a numerical value\n     * @param {L.LatLng} center\n     * @param {Number|Vector} value\n     * @param {Number} xSize\n     * @param {Number} ySize\n     */\n    constructor(center, value, xSize, ySize = xSize) {\n        this.center = center;\n        this.value = value;\n        this.xSize = xSize;\n        this.ySize = ySize;\n    }\n\n    equals(anotherCell) {\n        return (\n            this.center.equals(anotherCell.center) &&\n            this._equalValues(this.value, anotherCell.value) &&\n            this.xSize === anotherCell.xSize &&\n            this.ySize === anotherCell.ySize\n        );\n    }\n\n    _equalValues(value, anotherValue) {\n        let type = value.constructor.name;\n        let answerFor = {\n            Number: value === anotherValue,\n            Vector: value.u === anotherValue.u && value.v === anotherValue.v\n        };\n        return answerFor[type];\n    }\n\n    /**\n     * Bounds for the cell\n     * @returns {LatLngBounds}\n     */\n    getBounds() {\n        let halfX = this.xSize / 2.0;\n        let halfY = this.ySize / 2.0;\n        let cLat = this.center.lat;\n        let cLng = this.center.lng;\n        let ul = L.latLng([cLat + halfY, cLng - halfX]);\n        let lr = L.latLng([cLat - halfY, cLng + halfX]);\n\n        return L.latLngBounds(\n            L.latLng(lr.lat, ul.lng),\n            L.latLng(ul.lat, lr.lng)\n        );\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./Cell.js","import Cell from './Cell';\nimport inside from '@turf/inside';\n\n/**\n *  Abstract class for a set of values (Vector | Scalar)\n *  assigned to a regular 2D-grid (lon-lat), aka 'a Raster source'\n */\nexport default class Field {\n    constructor(params) {\n        this.params = params;\n\n        this.nCols = params['nCols'];\n        this.nRows = params['nRows'];\n\n        // alias\n        this.width = params['nCols'];\n        this.height = params['nRows'];\n\n        // ll = lower-left\n        this.xllCorner = params['xllCorner'];\n        this.yllCorner = params['yllCorner'];\n\n        // ur = upper-right\n        this.xurCorner =\n            params['xllCorner'] + params['nCols'] * params['cellXSize'];\n        this.yurCorner =\n            params['yllCorner'] + params['nRows'] * params['cellYSize'];\n\n        this.cellXSize = params['cellXSize'];\n        this.cellYSize = params['cellYSize'];\n\n        this.grid = null; // to be defined by subclasses\n        this.isContinuous = this.xurCorner - this.xllCorner >= 360;\n        this.longitudeNeedsToBeWrapped = this.xurCorner > 180; // [0, 360] --> [-180, 180]\n\n        this._inFilter = null;\n        this._spatialMask = null;\n    }\n\n    /**\n     * Builds a grid with a value at each point (either Vector or Number)\n     * Original params must include the required input values, following\n     * x-ascending & y-descending order (same as in ASCIIGrid)\n     * @abstract\n     * @private\n     * @returns {Array.<Array.<Vector|Number>>} - grid[row][column]--> Vector|Number\n     */\n    _buildGrid() {\n        throw new TypeError('Must be overriden');\n    }\n\n    _updateRange() {\n        this.range = this._calculateRange();\n    }\n\n    /**\n     * Number of cells in the grid (rows * cols)\n     * @returns {Number}\n     */\n    numCells() {\n        return this.nRows * this.nCols;\n    }\n\n    /**\n     * A list with every cell\n     * @returns {Array<Cell>} - cells (x-ascending & y-descending order)\n     */\n    getCells(stride = 1) {\n        let cells = [];\n        for (let j = 0; j < this.nRows; j = j + stride) {\n            for (let i = 0; i < this.nCols; i = i + stride) {\n                let [lon, lat] = this._lonLatAtIndexes(i, j);\n                let center = L.latLng(lat, lon);\n                let value = this._valueAtIndexes(i, j);\n                let c = new Cell(center, value, this.cellXSize, this.cellYSize);\n                cells.push(c); // <<\n            }\n        }\n        return cells;\n    }\n\n    /**\n     * Apply a filter function to field values\n     * @param   {Function} f - boolean function\n     */\n    setFilter(f) {\n        this._inFilter = f;\n        this._updateRange();\n    }\n\n    /**\n     * Apply a spatial mask to field values\n     * @param {L.GeoJSON} m \n     */\n    setSpatialMask(m) {\n        this._spatialMask = m;\n    }\n\n    /**\n     * Grid extent\n     * @returns {Number[]} [xmin, ymin, xmax, ymax]\n     */\n    extent() {\n        let [xmin, xmax] = this._getWrappedLongitudes();\n        return [xmin, this.yllCorner, xmax, this.yurCorner];\n    }\n\n    /**\n     * [xmin, xmax] in [-180, 180] range\n     */\n    _getWrappedLongitudes() {\n        let xmin = this.xllCorner;\n        let xmax = this.xurCorner;\n\n        if (this.longitudeNeedsToBeWrapped) {\n            if (this.isContinuous) {\n                xmin = -180;\n                xmax = 180;\n            } else {\n                // not sure about this (just one particular case, but others...?)\n                xmax = this.xurCorner - 360;\n                xmin = this.xllCorner - 360;\n                /* eslint-disable no-console */\n                // console.warn(`are these xmin: ${xmin} & xmax: ${xmax} OK?`);\n                // TODO: Better throw an exception on no-controlled situations.\n                /* eslint-enable no-console */\n            }\n        }\n        return [xmin, xmax];\n    }\n\n    /**\n     * Returns whether or not the grid contains the point, considering\n     * the spatialMask if it has been previously set\n     * @param   {Number} lon - longitude\n     * @param   {Number} lat - latitude\n     * @returns {Boolean}\n     */\n    contains(lon, lat) {\n        if (this._spatialMask) {\n            return this._pointInMask(lon, lat);\n        }\n        return this._pointInExtent(lon, lat);\n    }\n\n    /**\n     * Checks if coordinates are inside the Extent (considering wrapped longitudes if needed)\n     * @param {Number} lon \n     * @param {Number} lat \n     */\n    _pointInExtent(lon, lat) {\n        let [xmin, xmax] = this._getWrappedLongitudes();\n        let longitudeIn = lon >= xmin && lon <= xmax;\n        let latitudeIn = lat >= this.yllCorner && lat <= this.yurCorner;\n        return longitudeIn && latitudeIn;\n    }\n\n    /**\n     * Check if coordinates are inside the spatialMask (Point in Polygon analysis)\n     * @param {Number} lon \n     * @param {Number} lat \n     */\n    _pointInMask(lon, lat) {\n        const pt = {\n            type: 'Feature',\n            geometry: {\n                type: 'Point',\n                coordinates: [lon, lat] // geojson, lon-lat order !\n            },\n            properties: {}\n        };\n        const poly = this._spatialMask;\n        return inside(pt, poly);\n    }\n\n    /**\n     * Returns if the grid doesn't contain the point\n     * @param   {Number} lon - longitude\n     * @param   {Number} lat - latitude\n     * @returns {Boolean}\n     */\n    notContains(lon, lat) {\n        return !this.contains(lon, lat);\n    }\n\n    /**\n     * Interpolated value at lon-lat coordinates (bilinear method)\n     * @param   {Number} longitude\n     * @param   {Number} latitude\n     * @returns {Vector|Number} [u, v, magnitude]\n     *                          \n     * Source: https://github.com/cambecc/earth > product.js\n     */\n    interpolatedValueAt(lon, lat) {\n        if (this.notContains(lon, lat)) return null;\n\n        let [i, j] = this._getDecimalIndexes(lon, lat);\n        return this.interpolatedValueAtIndexes(i, j);\n    }\n\n    /**\n     * Interpolated value at i-j indexes (bilinear method)\n     * @param   {Number} i\n     * @param   {Number} j\n     * @returns {Vector|Number} [u, v, magnitude]\n     *\n     * Source: https://github.com/cambecc/earth > product.js\n     */\n    interpolatedValueAtIndexes(i, j) {\n        //         1      2           After converting  and  to fractional grid indexes i and j, we find the\n        //        fi  i   ci          four points 'G' that enclose point (i, j). These points are at the four\n        //         | =1.4 |           corners specified by the floor and ceiling of i and j. For example, given\n        //      ---G--|---G--- fj 8   i = 1.4 and j = 8.3, the four surrounding grid points are (1, 8), (2, 8),\n        //    j ___|_ .   |           (1, 9) and (2, 9).\n        //  =8.3   |      |\n        //      ---G------G--- cj 9   Note that for wrapped grids, the first column is duplicated as the last\n        //         |      |           column, so the index ci can be used without taking a modulo.\n\n        let indexes = this._getFourSurroundingIndexes(i, j);\n        let [fi, ci, fj, cj] = indexes;\n        let values = this._getFourSurroundingValues(fi, ci, fj, cj);\n        if (values) {\n            let [g00, g10, g01, g11] = values;\n            return this._doInterpolation(i - fi, j - fj, g00, g10, g01, g11);\n        }\n        return null;\n    }\n\n    /**\n     * Get decimal indexes\n     * @private\n     * @param {Number} lon\n     * @param {Number} lat\n     * @returns {Array}    [[Description]]\n     */\n    _getDecimalIndexes(lon, lat) {\n        if (this.longitudeNeedsToBeWrapped && lon < this.xllCorner) {\n            lon = lon + 360;\n        }\n        let i = (lon - this.xllCorner) / this.cellXSize;\n        let j = (this.yurCorner - lat) / this.cellYSize;\n        return [i, j];\n    }\n\n    /**\n     * Get surrounding indexes (integer), clampling on borders\n     * @private\n     * @param   {Number} i - decimal index\n     * @param   {Number} j - decimal index\n     * @returns {Array} [fi, ci, fj, cj]\n     */\n    _getFourSurroundingIndexes(i, j) {\n        let fi = Math.floor(i);\n        let ci = fi + 1;\n        // duplicate colum to simplify interpolation logic (wrapped value)\n        if (this.isContinuous && ci >= this.nCols) {\n            ci = 0;\n        }\n        ci = this._clampColumnIndex(ci);\n\n        let fj = this._clampRowIndex(Math.floor(j));\n        let cj = this._clampRowIndex(fj + 1);\n\n        return [fi, ci, fj, cj];\n    }\n\n    /**\n     * Get four surrounding values or null if not available,\n     * from 4 integer indexes\n     * @private\n     * @param   {Number} fi\n     * @param   {Number} ci\n     * @param   {Number} fj\n     * @param   {Number} cj\n     * @returns {Array} \n     */\n    _getFourSurroundingValues(fi, ci, fj, cj) {\n        var row;\n        if ((row = this.grid[fj])) {\n            // upper row ^^\n            var g00 = row[fi]; // << left\n            var g10 = row[ci]; // right >>\n            if (\n                this._isValid(g00) &&\n                this._isValid(g10) &&\n                (row = this.grid[cj])\n            ) {\n                // lower row vv\n                var g01 = row[fi]; // << left\n                var g11 = row[ci]; // right >>\n                if (this._isValid(g01) && this._isValid(g11)) {\n                    return [g00, g10, g01, g11]; // 4 values found!\n                }\n            }\n        }\n        return null;\n    }\n\n    /**\n     * Nearest value at lon-lat coordinates\n     * @param   {Number} longitude\n     * @param   {Number} latitude\n     * @returns {Vector|Number}\n     */\n    valueAt(lon, lat) {\n        if (this.notContains(lon, lat)) return null;\n\n        let [i, j] = this._getDecimalIndexes(lon, lat);\n        let ii = Math.floor(i);\n        let jj = Math.floor(j);\n\n        const ci = this._clampColumnIndex(ii);\n        const cj = this._clampRowIndex(jj);\n\n        let value = this._valueAtIndexes(ci, cj);\n        if (this._inFilter) {\n            if (!this._inFilter(value)) return null;\n        }\n\n        return value;\n    }\n\n    /**\n     * Returns whether or not the field has a value at the point\n     * @param   {Number} lon - longitude\n     * @param   {Number} lat - latitude\n     * @returns {Boolean}\n     */\n    hasValueAt(lon, lat) {\n        let value = this.valueAt(lon, lat);\n        let hasValue = value !== null;\n\n        let included = true;\n        if (this._inFilter) {\n            included = this._inFilter(value);\n        }\n        return hasValue && included;\n    }\n\n    /**\n     * Returns if the grid has no value at the point\n     * @param   {Number} lon - longitude\n     * @param   {Number} lat - latitude\n     * @returns {Boolean}\n     */\n    notHasValueAt(lon, lat) {\n        return !this.hasValueAt(lon, lat);\n    }\n\n    /**\n     * Gives a random position to 'o' inside the grid\n     * @param {Object} [o] - an object (eg. a particle)\n     * @returns {{x: Number, y: Number}} - object with x, y (lon, lat)\n     */\n    randomPosition(o = {}) {\n        let i = (Math.random() * this.nCols) | 0;\n        let j = (Math.random() * this.nRows) | 0;\n\n        o.x = this._longitudeAtX(i);\n        o.y = this._latitudeAtY(j);\n\n        return o;\n    }\n\n    /**\n     * Value for grid indexes\n     * @param   {Number} i - column index (integer)\n     * @param   {Number} j - row index (integer)\n     * @returns {Vector|Number}\n     */\n    _valueAtIndexes(i, j) {\n        return this.grid[j][i]; // <-- j,i !!\n    }\n\n    /**\n     * Lon-Lat for grid indexes\n     * @param   {Number} i - column index (integer)\n     * @param   {Number} j - row index (integer)\n     * @returns {Number[]} [lon, lat]\n     */\n    _lonLatAtIndexes(i, j) {\n        let lon = this._longitudeAtX(i);\n        let lat = this._latitudeAtY(j);\n\n        return [lon, lat];\n    }\n\n    /**\n     * Longitude for grid-index\n     * @param   {Number} i - column index (integer)\n     * @returns {Number} longitude at the center of the cell\n     */\n    _longitudeAtX(i) {\n        let halfXPixel = this.cellXSize / 2.0;\n        let lon = this.xllCorner + halfXPixel + i * this.cellXSize;\n        if (this.longitudeNeedsToBeWrapped) {\n            lon = lon > 180 ? lon - 360 : lon;\n        }\n        return lon;\n    }\n\n    /**\n     * Latitude for grid-index\n     * @param   {Number} j - row index (integer)\n     * @returns {Number} latitude at the center of the cell\n     */\n    _latitudeAtY(j) {\n        let halfYPixel = this.cellYSize / 2.0;\n        return this.yurCorner - halfYPixel - j * this.cellYSize;\n    }\n\n    /**\n     * Apply the interpolation\n     * @abstract\n     * @private\n     */\n    /* eslint-disable no-unused-vars */\n    _doInterpolation(x, y, g00, g10, g01, g11) {\n        throw new TypeError('Must be overriden');\n    }\n    /* eslint-disable no-unused-vars */\n\n    /**\n     * Check the column index is inside the field,\n     * adjusting to min or max when needed\n     * @private\n     * @param   {Number} ii - index\n     * @returns {Number} i - inside the allowed indexes\n     */\n    _clampColumnIndex(ii) {\n        let i = ii;\n        if (ii < 0) {\n            i = 0;\n        }\n        let maxCol = this.nCols - 1;\n        if (ii > maxCol) {\n            i = maxCol;\n        }\n        return i;\n    }\n\n    /**\n     * Check the row index is inside the field,\n     * adjusting to min or max when needed\n     * @private\n     * @param   {Number} jj index\n     * @returns {Number} j - inside the allowed indexes\n     */\n    _clampRowIndex(jj) {\n        let j = jj;\n        if (jj < 0) {\n            j = 0;\n        }\n        let maxRow = this.nRows - 1;\n        if (jj > maxRow) {\n            j = maxRow;\n        }\n        return j;\n    }\n\n    /**\n     * Is valid (not 'null' nor 'undefined')\n     * @private\n     * @param   {Object} x object\n     * @returns {Boolean}\n     */\n    _isValid(x) {\n        return x !== null && x !== undefined;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./Field.js","import Field from './Field';\n\n/**\n * Scalar Field\n */\nexport default class ScalarField extends Field {\n    /**\n     * Creates a ScalarField from the content of an ASCIIGrid file\n     * @param   {String}   asc\n     * @returns {ScalarField}\n     */\n    static fromASCIIGrid(asc, scaleFactor = 1) {\n        //console.time('ScalarField from ASC');\n\n        let lines = asc.split('\\n');\n\n        // Header\n        var header = ScalarField._parseASCIIGridHeader(lines.slice(0, 6));\n\n        // Data (left-right and top-down)\n        let zs = [];\n        for (let i = 6; i < lines.length; i++) {\n            let line = lines[i].trim();\n            if (line === '') break;\n\n            let items = line.split(' ');\n            items.forEach(it => {\n                let floatItem = parseFloat(it);\n                let v =\n                    floatItem !== header.noDataValue ?\n                    floatItem * scaleFactor :\n                    null;\n                zs.push(v);\n            });\n        }\n        let p = header;\n        p.zs = zs;\n\n        //console.timeEnd('ScalarField from ASC');\n        return new ScalarField(p);\n    }\n\n    /**\n     * Parse an ASCII Grid header, made with 6 lines\n     * It allows the use of XLLCORNER/YLLCORNER or XLLCENTER/YLLCENTER conventions\n     * @param {Array.String} headerLines\n     */\n    static _parseASCIIGridHeader(headerLines) {\n        try {\n            const headerItems = headerLines.map(line => {\n                var items = line.split(' ').filter(i => i != '');\n                var param = items[0].trim().toUpperCase();\n                var value = parseFloat(items[1].trim());\n                return {\n                    [param]: value\n                };\n            });\n\n            const usesCorner = 'XLLCORNER' in headerItems[2];\n            const cellSize = headerItems[4]['CELLSIZE'];\n\n            const header = {\n                nCols: parseInt(headerItems[0]['NCOLS']),\n                nRows: parseInt(headerItems[1]['NROWS']),\n                xllCorner: usesCorner ?\n                    headerItems[2]['XLLCORNER'] :\n                    headerItems[2]['XLLCENTER'] - cellSize / 2,\n                yllCorner: usesCorner ?\n                    headerItems[3]['YLLCORNER'] :\n                    headerItems[3]['YLLCENTER'] - cellSize / 2,\n                cellXSize: cellSize,\n                cellYSize: cellSize,\n                noDataValue: headerItems[5]['NODATA_VALUE']\n            };\n            return header;\n        } catch (err) {\n            throw new Error(`Not a valid ASCIIGrid Header: ${err}`);\n        }\n    }\n\n    /**\n     * Creates a ScalarField from the content of a GeoTIFF file\n     * @param   {ArrayBuffer}   data\n     * @param   {Number}   bandIndex\n     * @returns {ScalarField}\n     */\n    static fromGeoTIFF(data, bandIndex = 0) {\n        return ScalarField.multipleFromGeoTIFF(data, [bandIndex])[0];\n    }\n\n    /**\n     * Creates a ScalarField array (one per band) from the content of a GeoTIFF file\n     * @param   {ArrayBuffer}   data\n     * @param   {Array}   bandIndexes - if not provided all bands are returned\n     * @returns {Array.<ScalarField>}\n     */\n    static multipleFromGeoTIFF(data, bandIndexes) {\n        //console.time('ScalarField from GeoTIFF');\n\n        let tiff = GeoTIFF.parse(data); // geotiff.js\n        let image = tiff.getImage();\n        let rasters = image.readRasters();\n        let tiepoint = image.getTiePoints()[0];\n        let fileDirectory = image.getFileDirectory();\n        let [xScale, yScale] = fileDirectory.ModelPixelScale;\n\n        if (typeof bandIndexes === 'undefined' || bandIndexes.length === 0) {\n            bandIndexes = [...Array(rasters.length).keys()];\n        }\n\n        let scalarFields = [];\n        scalarFields = bandIndexes.map(function (bandIndex) {\n            let zs = rasters[bandIndex]; // left-right and top-down order\n\n            if (fileDirectory.GDAL_NODATA) {\n                let noData = parseFloat(fileDirectory.GDAL_NODATA);\n                // console.log(noData);\n                let simpleZS = Array.from(zs); // to simple array, so null is allowed | TODO efficiency??\n                zs = simpleZS.map(function (z) {\n                    return z === noData ? null : z;\n                });\n            }\n\n            let p = {\n                nCols: image.getWidth(),\n                nRows: image.getHeight(),\n                xllCorner: tiepoint.x,\n                yllCorner: tiepoint.y - image.getHeight() * yScale,\n                cellXSize: xScale,\n                cellYSize: yScale,\n                zs: zs\n            };\n            return new ScalarField(p);\n        });\n\n        //console.timeEnd('ScalarField from GeoTIFF');\n        return scalarFields;\n    }\n\n    constructor(params) {\n        super(params);\n        this.zs = params['zs'];\n\n        this.grid = this._buildGrid();\n        this._updateRange();\n        //console.log(`ScalarField created (${this.nCols} x ${this.nRows})`);\n    }\n\n    /**\n     * Builds a grid with a Number at each point, from an array\n     * 'zs' following x-ascending & y-descending order\n     * (same as in ASCIIGrid)\n     * @private\n     * @returns {Array.<Array.<Number>>} - grid[row][column]--> Number\n     */\n    _buildGrid() {\n        let grid = this._arrayTo2d(this.zs, this.nRows, this.nCols);\n        return grid;\n    }\n\n    _arrayTo2d(array, nRows, nCols) {\n        let grid = [];\n        let p = 0;\n        for (var j = 0; j < nRows; j++) {\n            var row = [];\n            for (var i = 0; i < nCols; i++, p++) {\n                let z = array[p];\n                row[i] = this._isValid(z) ? z : null; // <<<\n            }\n            grid[j] = row;\n        }\n        return grid;\n    }\n\n    _newDataArrays(params) {\n        params['zs'] = [];\n    }\n\n    _pushValueToArrays(params, value) {\n        params['zs'].push(value);\n    }\n\n    _makeNewFrom(params) {\n        return new ScalarField(params);\n    }\n\n    /**\n     * Calculate min & max values\n     * @private\n     * @returns {Array} - [min, max]\n     */\n    _calculateRange() {\n        var data = this.zs;\n        if (this._inFilter) {\n            data = data.filter(this._inFilter);\n        }\n        return [d3.min(data), d3.max(data)];\n    }\n\n    /**\n     * Bilinear interpolation for Number\n     * https://en.wikipedia.org/wiki/Bilinear_interpolation\n     * @param   {Number} x\n     * @param   {Number} y\n     * @param   {Number} g00\n     * @param   {Number} g10\n     * @param   {Number} g01\n     * @param   {Number} g11\n     * @returns {Number}\n     */\n    _doInterpolation(x, y, g00, g10, g01, g11) {\n        var rx = 1 - x;\n        var ry = 1 - y;\n        return g00 * rx * ry + g10 * x * ry + g01 * rx * y + g11 * x * y;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./ScalarField.js","/**\n *  2D Vector\n */\nexport default class Vector {\n\n    constructor(u, v) {\n        this.u = u;\n        this.v = v;\n    }\n\n    /**\n     * Magnitude\n     * @returns {Number}\n     */\n    magnitude() {\n        return Math.sqrt(this.u * this.u + this.v * this.v);\n    }\n\n    /**\n     * Angle in degrees (0 to 360) --> Towards\n     * N is 0 and E is 90\n     * @returns {Number}\n     */\n    directionTo() {\n        let verticalAngle = Math.atan2(this.u, this.v);\n        let inDegrees = verticalAngle * (180.0 / Math.PI);\n        if (inDegrees < 0) {\n            inDegrees = inDegrees + 360.0;\n        }\n        return inDegrees;\n    }\n\n    /**\n     * Angle in degrees (0 to 360) From x-->\n     * N is 0 and E is 90\n     * @returns {Number}\n     */\n    directionFrom() {\n        let a = this.directionTo();\n        let opposite = (a + 180.0) % 360.0;\n        return opposite;\n    }\n\n    /*\n        Degrees --> text\n        new Dictionary<int, string>\n        {\n            //{0, 23, 45, 68, 90, 113, 135, 158, 180, 203, 225, 248, 270, 293, 315, 338, 360};\n            {0, 'N'},\n            {23, 'NNE'},\n            {45, 'NE'},\n            {68, 'ENE'},\n            {90, 'E'},\n            {113, 'ESE'},\n            {135, 'SE'},\n            {158, 'SSE'},\n            {180, 'S'},\n            {203, 'SSW'},\n            {225, 'SW'},\n            {248, 'WSW'},\n            {270, 'W'},\n            {293, 'WNW'},\n            {315, 'NW'},\n            {338, 'NNW'},\n            {360, 'N'}\n        };\n    */\n}\n\n\n\n// WEBPACK FOOTER //\n// ./Vector.js","import Vector from './Vector';\nimport Field from './Field';\nimport ScalarField from './ScalarField';\n\n/**\n *  A set of vectors assigned to a regular 2D-grid (lon-lat)\n *  (e.g. a raster representing winds for a region)\n */\nexport default class VectorField extends Field {\n    /**\n     * Creates a VectorField from the content of two ASCIIGrid files\n     * @param   {String} ascU - with u-component\n     * @param   {String} ascV - with v-component\n     * @returns {VectorField}\n     */\n    static fromASCIIGrids(ascU, ascV, scaleFactor = 1) {\n        let u = ScalarField.fromASCIIGrid(ascU, scaleFactor);\n        let v = ScalarField.fromASCIIGrid(ascV, scaleFactor);\n        let p = VectorField._paramsFromScalarFields(u, v);\n\n        return new VectorField(p);\n    }\n\n    /**\n     * Creates a VectorField from the content of two different Geotiff files\n     * @param   {ArrayBuffer} gtU - geotiff data with u-component (band 0)\n     * @param   {ArrayBuffer} gtV - geotiff data with v-component (band 0)\n     * @returns {VectorField}\n     */\n    static fromGeoTIFFs(gtU, gtV) {\n        let u = ScalarField.fromGeoTIFF(gtU);\n        let v = ScalarField.fromGeoTIFF(gtV);\n        let p = VectorField._paramsFromScalarFields(u, v);\n\n        return new VectorField(p);\n    }\n\n    /**\n     * Creates a VectorField from the content of Multiband Geotiff\n     * @param   {ArrayBuffer} geotiffData - multiband\n     * @param   {Array} bandIndexesForUV\n     * @returns {VectorField}\n     */\n    static fromMultibandGeoTIFF(geotiffData, bandIndexesForUV = [0, 1]) {\n        let [u, v] = ScalarField.multipleFromGeoTIFF(\n            geotiffData,\n            bandIndexesForUV\n        );\n        let p = VectorField._paramsFromScalarFields(u, v);\n\n        return new VectorField(p);\n    }\n\n    /**\n     * Build parameters for VectorField, from 2 ScalarFields.\n     * No validation at all (nor interpolation) is applied, so u and v\n     * must be 'compatible' from the source\n     * @param   {ScalarField} u\n     * @param   {ScalarField} v\n     * @returns {Object} - parameters to build VectorField\n     */\n    static _paramsFromScalarFields(u, v) {\n        // TODO check u & v compatibility (cellSize...)\n        let p = {\n            nCols: u.nCols,\n            nRows: u.nRows,\n            xllCorner: u.xllCorner,\n            yllCorner: u.yllCorner,\n            cellXSize: u.cellXSize,\n            cellYSize: u.cellYSize,\n            us: u.zs,\n            vs: v.zs\n        };\n        return p;\n    }\n\n    constructor(params) {\n        super(params);\n\n        this.us = params['us'];\n        this.vs = params['vs'];\n        this.grid = this._buildGrid();\n        this.range = this._calculateRange();\n    }\n\n    /**\n     * Get a derived field, from a computation on\n     * the VectorField\n     * @param   {String} type ['magnitude' | 'directionTo' | 'directionFrom']\n     * @returns {ScalarField}\n     */\n    getScalarField(type) {\n        let f = this._getFunctionFor(type);\n        let p = {\n            nCols: this.params.nCols,\n            nRows: this.params.nRows,\n            xllCorner: this.params.xllCorner,\n            yllCorner: this.params.yllCorner,\n            cellXSize: this.params.cellXSize,\n            cellYSize: this.params.cellYSize,\n            zs: this._applyOnField(f)\n        };\n        return new ScalarField(p);\n    }\n\n    _getFunctionFor(type) {\n        return function(u, v) {\n            let uv = new Vector(u, v);\n            return uv[type](); // magnitude, directionTo, directionFrom\n        };\n    }\n\n    _applyOnField(func) {\n        let zs = [];\n        let n = this.numCells();\n        for (var i = 0; i < n; i++) {\n            let u = this.us[i];\n            let v = this.vs[i];\n            if (this._isValid(u) && this._isValid(v)) {\n                zs.push(func(u, v));\n            } else {\n                zs.push(null);\n            }\n        }\n        return zs;\n    }\n\n    /**\n     * Builds a grid with a Vector at each point, from two arrays\n     * 'us' and 'vs' following x-ascending & y-descending order\n     * (same as in ASCIIGrid)\n     * @returns {Array.<Array.<Vector>>} - grid[row][column]--> Vector\n     */\n    _buildGrid() {\n        let grid = this._arraysTo2d(this.us, this.vs, this.nRows, this.nCols);\n        return grid;\n    }\n\n    _arraysTo2d(us, vs, nRows, nCols) {\n        let grid = [];\n        let p = 0;\n\n        for (var j = 0; j < nRows; j++) {\n            var row = [];\n            for (var i = 0; i < nCols; i++, p++) {\n                let u = us[p],\n                    v = vs[p];\n                let valid = this._isValid(u) && this._isValid(v);\n                row[i] = valid ? new Vector(u, v) : null; // <<<\n            }\n            grid[j] = row;\n        }\n        return grid;\n    }\n\n    _newDataArrays(params) {\n        params['us'] = [];\n        params['vs'] = [];\n    }\n    _pushValueToArrays(params, value) {\n        //console.log(value);\n        params['us'].push(value.u);\n        params['vs'].push(value.v);\n    }\n    _makeNewFrom(params) {\n        return new VectorField(params);\n    }\n\n    /**\n     * Calculate min & max values (magnitude)\n     * @private\n     * @returns {Array}\n     */\n    _calculateRange() {\n        // TODO make a clearer method for getting these vectors...\n        let vectors = this.getCells()\n            .map(pt => pt.value)\n            .filter(function(v) {\n                return v !== null;\n            });\n\n        if (this._inFilter) {\n            vectors = vectors.filter(this._inFilter);\n        }\n\n        // TODO check memory crash with high num of vectors!\n        let magnitudes = vectors.map(v => v.magnitude());\n        let min = d3.min(magnitudes);\n        let max = d3.max(magnitudes);\n\n        return [min, max];\n    }\n\n    /**\n     * Bilinear interpolation for Vector\n     * https://en.wikipedia.org/wiki/Bilinear_interpolation\n     * @param   {Number} x\n     * @param   {Number} y\n     * @param   {Number[]} g00\n     * @param   {Number[]} g10\n     * @param   {Number[]} g01\n     * @param   {Number[]} g11\n     * @returns {Vector}\n     */\n    _doInterpolation(x, y, g00, g10, g01, g11) {\n        var rx = 1 - x;\n        var ry = 1 - y;\n        var a = rx * ry,\n            b = x * ry,\n            c = rx * y,\n            d = x * y;\n        var u = g00.u * a + g10.u * b + g01.u * c + g11.u * d;\n        var v = g00.v * a + g10.v * b + g01.v * c + g11.v * d;\n        return new Vector(u, v);\n    }\n\n    /**\n     * Is valid (not 'null' nor 'undefined')\n     * @private\n     * @param   {Object} x object\n     * @returns {Boolean}\n     */\n    _isValid(x) {\n        return x !== null && x !== undefined;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./VectorField.js","/**\n *   Control for a simple legend with a colorbar\n *   References:\n *      - http://jsfiddle.net/ramnathv/g8stqcf6/\n *      - http://jsfiddle.net/vis4/cYLZH/\n */\nL.Control.ColorBar = L.Control.extend({\n    options: {\n        position: 'bottomleft',\n        width: 300, // for colorbar itself (control is wider)\n        height: 15,\n        margin: 15,\n        background: '#fff',\n        textColor: 'black',\n        steps: 100,\n        decimals: 2,\n        units: 'uds', // ej: m/s\n        title: 'Legend', // ej: Ocean Currents\n        labels: [], // empty for no labels\n        textLabels: [], // empty for default labels. Custom labels ej: ['low', 'mid','high'] \n        labelFontSize: 10,\n        labelTextPosition: 'middle' // start | middle | end\n    },\n\n    initialize: function (color, range, options) {\n        this.color = color; // 'chromajs' scale function\n        this.range = range; // [min, max]\n        L.Util.setOptions(this, options);\n    },\n\n    onAdd: function (map) {\n        this._map = map;\n        let div = L.DomUtil.create(\n            'div',\n            'leaflet-control-colorBar leaflet-bar leaflet-control'\n        );\n        div.style.padding = '10px';\n\n        L.DomEvent\n            .addListener(div, 'click', L.DomEvent.stopPropagation)\n            .addListener(div, 'click', L.DomEvent.preventDefault);\n        div.style.backgroundColor = this.options.background;\n        div.style.cursor = 'text';\n        div.innerHTML = this.title() + this.palette();\n        return div;\n    },\n\n    title: function () {\n        let d = document.createElement('div');\n        d3\n            .select(d)\n            .append('span')\n            .style('color', this.options.textColor)\n            .style('display', 'block')\n            .style('margin-bottom', '5px')\n            .attr('class', 'leaflet-control-colorBar-title')\n            .text(this.options.title);\n        return d.innerHTML;\n    },\n\n    palette: function () {\n        let d = document.createElement('div');\n        let svg = this._createSvgIn(d);\n\n        this._appendColorBarTo(svg);\n\n        if (this.options.labels) {\n            this._appendLabelsTo(svg);\n        }\n\n        return d.innerHTML;\n    },\n\n    _createSvgIn: function (d) {\n        let spaceForLabels = this.options.labels ? this.options.margin : 0;\n        let svg = d3\n            .select(d)\n            .append('svg')\n            .attr('width', this.options.width + this.options.margin * 2)\n            .attr('height', this.options.height + spaceForLabels);\n        return svg;\n    },\n\n    _appendColorBarTo: function (svg) {\n        const colorPerValue = this._getColorPerValue();\n        const w = this.options.width / colorPerValue.length;\n\n        let groupBars = svg.append('g').attr('id', 'colorBar-buckets');\n        let buckets = groupBars\n            .selectAll('rect')\n            .data(colorPerValue)\n            .enter()\n            .append('rect');\n        buckets\n            .attr('x', (d, i) => i * w + this.options.margin)\n            .attr('y', () => 0)\n            .attr('height', () => this.options.height /*w * 4*/ )\n            .attr('width', () => w)\n            .attr('stroke-width', 2)\n            .attr('stroke-linecap', 'butt')\n            .attr('stroke', d => d.color.hex())\n            .attr('fill', d => d.color.hex());\n        buckets\n            .append('title')\n            .text(\n                d =>\n                `${d.value.toFixed(this.options.decimals)} ${this.options\n                        .units}`\n            );\n    },\n\n    _appendLabelsTo: function (svg) {\n        const positionPerLabelValue = this._getPositionPerLabelValue();\n        //const w = this.options.width / colorPerValue.length;\n        let groupLabels = svg.append('g').attr('id', 'colorBar-labels');\n        let labels = groupLabels\n            .selectAll('text')\n            .data(positionPerLabelValue)\n            .enter()\n            .append('text');\n        labels\n            .attr('x', d => d.position + this.options.margin)\n            .attr('y', this.options.height + this.options.margin)\n            .attr('font-size', `${this.options.labelFontSize}px`)\n            .attr('text-anchor', this.options.labelTextPosition)\n            .attr('fill', this.options.textColor)\n            .attr('class', 'leaflet-control-colorBar-label')\n            .text(d => this.options.textLabels ? d.label : `${d.value.toFixed(this.options.decimals)}`);\n    },\n\n    _getColorPerValue: function () {\n        const [min, max] = this.range;\n        let delta = (max - min) / this.options.steps;\n        let data = d3.range(min, max + delta, delta);\n        let colorPerValue = data.map(d => {\n            return {\n                value: d,\n                color: this.color(d)\n            };\n        });\n        return colorPerValue;\n    },\n\n    _getPositionPerLabelValue: function () {\n        var xPositionFor = d3\n            .scaleLinear()\n            .range([0, this.options.width])\n            .domain(this.range);\n        let data = this.options.labels;\n        let positionPerLabel = data.map((d, index) => {\n            return {\n                label: this.options.textLabels ? this.options.textLabels[index] : '',\n                value: d,\n                position: xPositionFor(d)\n            };\n        });\n        return positionPerLabel;\n    }\n});\n\nL.control.colorBar = function (color, range, options) {\n    return new L.Control.ColorBar(color, range, options);\n};\n\n\n// WEBPACK FOOTER //\n// ./control/L.Control.ColorBar.js","/**\n * Abstract class for a Field layer on canvas, aka 'a Raster layer'\n * (ScalarField or a VectorField)\n */\nL.CanvasLayer.Field = L.CanvasLayer.extend({\n    options: {\n        mouseMoveCursor: {\n            value: 'pointer',\n            noValue: 'default'\n        },\n        opacity: 1,\n        onClick: null,\n        onMouseMove: null,\n        inFilter: null\n    },\n\n    initialize: function(field, options) {\n        L.Util.setOptions(this, options);\n        this._visible = true;\n        if (field) {\n            this.setData(field);\n        }\n    },\n\n    getEvents: function() {\n        var events = L.CanvasLayer.prototype.getEvents.call(this);\n        events.zoomstart = this._hideCanvas.bind(this);\n        events.zoomend = this._showCanvas.bind(this);\n        return events;\n    },\n\n    onLayerDidMount: function() {\n        this._enableIdentify();\n        this._ensureCanvasAlignment();\n    },\n\n    show() {\n        this._visible = true;\n        this._showCanvas();\n        this._enableIdentify();\n    },\n\n    hide() {\n        this._visible = false;\n        this._hideCanvas();\n        this._disableIdentify();\n    },\n\n    isVisible() {\n        return this._visible;\n    },\n\n    _showCanvas() {\n        if (this._canvas && this._visible) {\n            this._canvas.style.visibility = 'visible';\n        }\n    },\n\n    _hideCanvas() {\n        if (this._canvas) {\n            this._canvas.style.visibility = 'hidden';\n        }\n    },\n\n    _enableIdentify() {\n        this._map.on('click', this._onClick, this);\n        this._map.on('mousemove', this._onMouseMove, this);\n\n        this.options.onClick && this.on('click', this.options.onClick, this);\n        this.options.onMouseMove &&\n            this.on('mousemove', this.options.onMouseMove, this);\n    },\n\n    _disableIdentify() {\n        this._map.off('click', this._onClick, this);\n        this._map.off('mousemove', this._onMouseMove, this);\n\n        this.options.onClick && this.off('click', this.options.onClick, this);\n        this.options.onMouseMove &&\n            this.off('mousemove', this.options.onMouseMove, this);\n    },\n\n    _ensureCanvasAlignment() {\n        var topLeft = this._map.containerPointToLayerPoint([0, 0]);\n        L.DomUtil.setPosition(this._canvas, topLeft);\n    },\n\n    onLayerWillUnmount: function() {\n        this._disableIdentify();\n    },\n\n    needRedraw() {\n        if (this._map && this._field) {\n            L.CanvasLayer.prototype.needRedraw.call(this);\n        }\n    },\n\n    /* eslint-disable no-unused-vars */\n    onDrawLayer: function(viewInfo) {\n        throw new TypeError('Must be overriden');\n    },\n    /* eslint-enable no-unused-vars */\n\n    setData: function(field) {\n        this.options.inFilter && field.setFilter(this.options.inFilter);\n        this._field = field;\n        this.needRedraw();\n        this.fire('load');\n    },\n\n    setFilter: function(f) {\n        this.options.inFilter = f;\n        this._field && this._field.setFilter(f);\n        this.needRedraw();\n    },\n\n    setOpacity: function(opacity) {\n        this.options.opacity = opacity;\n\n        if (this._canvas) {\n            this._updateOpacity();\n        }\n        return this;\n    },\n\n    getBounds: function() {\n        let bb = this._field.extent();\n\n        let southWest = L.latLng(bb[1], bb[0]),\n            northEast = L.latLng(bb[3], bb[2]);\n        let bounds = L.latLngBounds(southWest, northEast);\n        return bounds;\n    },\n\n    _onClick: function(e) {\n        let v = this._queryValue(e);\n        this.fire('click', v);\n    },\n\n    _onMouseMove: function(e) {\n        let v = this._queryValue(e);\n        this._changeCursorOn(v);\n        this.fire('mousemove', v);\n    },\n\n    _changeCursorOn: function(v) {\n        if (!this.options.mouseMoveCursor) return;\n\n        let { value, noValue } = this.options.mouseMoveCursor;\n        let style = this._map.getContainer().style;\n        style.cursor = v.value !== null ? value : noValue;\n    },\n\n    _updateOpacity: function() {\n        L.DomUtil.setOpacity(this._canvas, this.options.opacity);\n    },\n\n    _queryValue: function(e) {\n        let v = this._field\n            ? this._field.valueAt(e.latlng.lng, e.latlng.lat)\n            : null;\n        let result = {\n            latlng: e.latlng,\n            value: v\n        };\n        return result;\n    },\n\n    _getDrawingContext: function() {\n        let g = this._canvas.getContext('2d');\n        g.clearRect(0, 0, this._canvas.width, this._canvas.height);\n        return g;\n    }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./layer/L.CanvasLayer.Field.js","import Cell from '../Cell';\n\n/**\n * ScalarField on canvas (a 'Raster')\n */\nL.CanvasLayer.ScalarField = L.CanvasLayer.Field.extend({\n    options: {\n        type: 'colormap', // [colormap|vector]\n        color: null, // function colorFor(value) [e.g. chromajs.scale],\n        interpolate: false, // Change to use interpolation\n        vectorSize: 20, // only used if 'vector'\n        arrowDirection: 'from' // [from|towards]\n    },\n\n    initialize: function(scalarField, options) {\n        L.CanvasLayer.Field.prototype.initialize.call(\n            this,\n            scalarField,\n            options\n        );\n        L.Util.setOptions(this, options);\n    },\n\n    _defaultColorScale: function() {\n        return chroma.scale(['white', 'black']).domain(this._field.range);\n    },\n\n    setColor(f) {\n        this.options.color = f;\n        this.needRedraw();\n    },\n\n    /* eslint-disable no-unused-vars */\n    onDrawLayer: function(viewInfo) {\n        if (!this.isVisible()) return;\n        this._updateOpacity();\n\n        let r = this._getRendererMethod();\n        //console.time('onDrawLayer');\n        r();\n        //console.timeEnd('onDrawLayer');\n    },\n    /* eslint-enable no-unused-vars */\n\n    _getRendererMethod: function() {\n        switch (this.options.type) {\n            case 'colormap':\n                return this._drawImage.bind(this);\n            case 'vector':\n                return this._drawArrows.bind(this);\n            default:\n                throw Error(`Unkwown renderer type: ${this.options.type}`);\n        }\n    },\n\n    _ensureColor: function() {\n        if (this.options.color === null) {\n            this.setColor(this._defaultColorScale());\n        }\n    },\n\n    _showCanvas() {\n        L.CanvasLayer.Field.prototype._showCanvas.call(this);\n        this.needRedraw(); // TODO check spurious redraw (e.g. hide/show without moving map)\n    },\n\n    /**\n     * Draws the field in an ImageData and applying it with putImageData.\n     * Used as a reference: http://geoexamples.com/d3-raster-tools-docs/code_samples/raster-pixels-page.html\n     */\n    _drawImage: function() {\n        this._ensureColor();\n\n        let ctx = this._getDrawingContext();\n        let width = this._canvas.width;\n        let height = this._canvas.height;\n\n        let img = ctx.createImageData(width, height);\n        let data = img.data;\n\n        this._prepareImageIn(data, width, height);\n        ctx.putImageData(img, 0, 0);\n    },\n\n    /**\n     * Prepares the image in data, as array with RGBAs\n     * [R1, G1, B1, A1, R2, G2, B2, A2...]\n     * @private\n     * @param {[[Type]]} data   [[Description]]\n     * @param {Numver} width\n     * @param {Number} height\n     */\n    _prepareImageIn(data, width, height) {\n        let f = this.options.interpolate ? 'interpolatedValueAt' : 'valueAt';\n\n        let pos = 0;\n        for (let j = 0; j < height; j++) {\n            for (let i = 0; i < width; i++) {\n                let pointCoords = this._map.containerPointToLatLng([i, j]);\n                let lon = pointCoords.lng;\n                let lat = pointCoords.lat;\n\n                let v = this._field[f](lon, lat); // 'valueAt' | 'interpolatedValueAt' || TODO check some 'artifacts'\n                if (v !== null) {\n                    let color = this._getColorFor(v);\n                    let [R, G, B, A] = color.rgba();\n                    data[pos] = R;\n                    data[pos + 1] = G;\n                    data[pos + 2] = B;\n                    data[pos + 3] = parseInt(A * 255); // not percent in alpha but hex 0-255\n                }\n                pos = pos + 4;\n            }\n        }\n    },\n\n    /**\n     * Draws the field as a set of arrows. Direction from 0 to 360 is assumed.\n     */\n    _drawArrows: function() {\n        const bounds = this._pixelBounds();\n        const pixelSize = (bounds.max.x - bounds.min.x) / this._field.nCols;\n\n        var stride = Math.max(\n            1,\n            Math.floor(1.2 * this.options.vectorSize / pixelSize)\n        );\n\n        const ctx = this._getDrawingContext();\n        ctx.strokeStyle = this.options.color;\n\n        var currentBounds = this._map.getBounds();\n\n        for (var y = 0; y < this._field.height; y = y + stride) {\n            for (var x = 0; x < this._field.width; x = x + stride) {\n                let [lon, lat] = this._field._lonLatAtIndexes(x, y);\n                let v = this._field.valueAt(lon, lat);\n                let center = L.latLng(lat, lon);\n                if (v !== null && currentBounds.contains(center)) {\n                    let cell = new Cell(\n                        center,\n                        v,\n                        this.cellXSize,\n                        this.cellYSize\n                    );\n                    this._drawArrow(cell, ctx);\n                }\n            }\n        }\n    },\n\n    _pixelBounds: function() {\n        const bounds = this.getBounds();\n        const northWest = this._map.latLngToContainerPoint(\n            bounds.getNorthWest()\n        );\n        const southEast = this._map.latLngToContainerPoint(\n            bounds.getSouthEast()\n        );\n        var pixelBounds = L.bounds(northWest, southEast);\n        return pixelBounds;\n    },\n\n    _drawArrow: function(cell, ctx) {\n        var projected = this._map.latLngToContainerPoint(cell.center);\n\n        // colormap vs. simple color\n        let color = this.options.color;\n        if (typeof color === 'function') {\n            ctx.strokeStyle = color(cell.value);\n        }\n\n        const size = this.options.vectorSize;\n        ctx.save();\n\n        ctx.translate(projected.x, projected.y);\n\n        let rotationRads = (90 + cell.value) * Math.PI / 180; // from, by default\n        if (this.options.arrowDirection === 'towards') {\n            rotationRads = rotationRads + Math.PI;\n        }\n        ctx.rotate(rotationRads);\n\n        ctx.beginPath();\n        ctx.moveTo(-size / 2, 0);\n        ctx.lineTo(+size / 2, 0);\n        ctx.moveTo(size * 0.25, -size * 0.25);\n        ctx.lineTo(+size / 2, 0);\n        ctx.lineTo(size * 0.25, size * 0.25);\n        ctx.stroke();\n        ctx.restore();\n    },\n\n    /**\n     * Gets a chroma color for a pixel value, according to 'options.color'\n     */\n    _getColorFor(v) {\n        let c = this.options.color; // e.g. for a constant 'red'\n        if (typeof c === 'function') {\n            c = this.options.color(v);\n        }\n        let color = chroma(c); // to be more flexible, a chroma color object is always created || TODO improve efficiency\n        return color;\n    }\n});\n\nL.canvasLayer.scalarField = function(scalarField, options) {\n    return new L.CanvasLayer.ScalarField(scalarField, options);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./layer/L.CanvasLayer.ScalarField.js","/**\n *  Simple layer with lon-lat points\n *\n *  TODO rename to SimplePoint?\n */\nL.CanvasLayer.SimpleLonLat = L.CanvasLayer.extend({\n    options: {\n        color: 'gray',\n        size: 2\n    },\n\n    initialize: function(points, options) {\n        this.points = points;\n        L.Util.setOptions(this, options);\n    },\n\n    onLayerDidMount: function() {\n        // -- prepare custom drawing\n    },\n\n    onLayerWillUnmount: function() {\n        // -- custom cleanup\n    },\n\n    /* eslint-disable no-unused-vars */\n    setData: function(data) {\n        // -- custom data set\n        this.needRedraw(); // -- call to drawLayer\n    },\n    /* eslint-enable no-unused-vars */\n\n    onDrawLayer: function(viewInfo) {\n        // canvas preparation\n        let g = viewInfo.canvas.getContext('2d');\n        g.clearRect(0, 0, viewInfo.canvas.width, viewInfo.canvas.height);\n        g.fillStyle = this.options.color;\n\n        for (let point of this.points) {\n            let p = viewInfo.layer._map.latLngToContainerPoint(point);\n            g.beginPath();\n            //g.arc(p.x, p.y, 1, 0, Math.PI * 2); // circle | TODO style 'function' as parameter?\n            g.fillRect(p.x, p.y, this.options.size, this.options.size); //simple point\n            g.fill();\n            g.closePath();\n            g.stroke();\n        }\n    },\n\n    getBounds: function() {\n        // TODO: bounding with points...\n        let xs = this.points.map(pt => pt.lng);\n        let ys = this.points.map(pt => pt.lat);\n\n        let xmin = Math.min(...xs);\n        let ymin = Math.min(...ys);\n        let xmax = Math.max(...xs);\n        let ymax = Math.max(...ys);\n\n        let southWest = L.latLng(ymin, xmin),\n            northEast = L.latLng(ymax, xmax);\n        let bounds = L.latLngBounds(southWest, northEast); // TODO FIX ERROR ? half-pixel?\n        return bounds;\n    }\n});\n\nL.canvasLayer.simpleLonLat = function(lonslats, options) {\n    return new L.CanvasLayer.SimpleLonLat(lonslats, options);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./layer/L.CanvasLayer.SimpleLonLat.js","/**\n * Animated VectorField on canvas\n */\nL.CanvasLayer.VectorFieldAnim = L.CanvasLayer.Field.extend({\n    options: {\n        paths: 800,\n        color: 'white', // html-color | function colorFor(value) [e.g. chromajs.scale]\n        width: 1.0, // number | function widthFor(value)\n        fade: 0.96, // 0 to 1\n        duration: 20, // milliseconds per 'frame'\n        maxAge: 200, // number of maximum frames per path\n        velocityScale: 1 / 5000\n    },\n\n    initialize: function(vectorField, options) {\n        L.CanvasLayer.Field.prototype.initialize.call(\n            this,\n            vectorField,\n            options\n        );\n        L.Util.setOptions(this, options);\n\n        this.timer = null;\n    },\n\n    onLayerDidMount: function() {\n        L.CanvasLayer.Field.prototype.onLayerDidMount.call(this);\n        this._map.on('move resize', this._stopAnimation, this);\n    },\n\n    onLayerWillUnmount: function() {\n        L.CanvasLayer.Field.prototype.onLayerWillUnmount.call(this);\n        this._map.off('move resize', this._stopAnimation, this);\n        this._stopAnimation();\n    },\n\n    _hideCanvas: function _showCanvas() {\n        L.CanvasLayer.Field.prototype._hideCanvas.call(this);\n        this._stopAnimation();\n    },\n\n    onDrawLayer: function(viewInfo) {\n        if (!this._field || !this.isVisible()) return;\n\n        this._updateOpacity();\n\n        let ctx = this._getDrawingContext();\n        let paths = this._prepareParticlePaths();\n\n        this.timer = d3.timer(function() {\n            _moveParticles();\n            _drawParticles();\n        }, this.options.duration);\n\n        let self = this;\n\n        /**\n         * Builds the paths, adding 'particles' on each animation step, considering\n         * their properties (age / position source > target)\n         */\n        function _moveParticles() {\n            // let screenFactor = 1 / self._map.getZoom(); // consider using a 'screenFactor' to ponderate velocityScale\n            paths.forEach(function(par) {\n                if (par.age > self.options.maxAge) {\n                    // restart, on a random x,y\n                    par.age = 0;\n                    self._field.randomPosition(par);\n                }\n\n                let vector = self._field.valueAt(par.x, par.y);\n                if (vector === null) {\n                    par.age = self.options.maxAge;\n                } else {\n                    // the next point will be...\n                    let xt = par.x + vector.u * self.options.velocityScale; //* screenFactor;\n                    let yt = par.y + vector.v * self.options.velocityScale; //* screenFactor;\n\n                    if (self._field.hasValueAt(xt, yt)) {\n                        par.xt = xt;\n                        par.yt = yt;\n                        par.m = vector.magnitude();\n                    } else {\n                        // not visible anymore...\n                        par.age = self.options.maxAge;\n                    }\n                }\n                par.age += 1;\n            });\n        }\n\n        /**\n         * Draws the paths on each step\n         */\n        function _drawParticles() {\n            // Previous paths...\n            let prev = ctx.globalCompositeOperation;\n            ctx.globalCompositeOperation = 'destination-in';\n            ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n            //ctx.globalCompositeOperation = 'source-over';\n            ctx.globalCompositeOperation = prev;\n\n            // fading paths...\n            ctx.fillStyle = `rgba(0, 0, 0, ${self.options.fade})`;\n            ctx.lineWidth = self.options.width;\n            ctx.strokeStyle = self.options.color;\n\n            // New paths\n            paths.forEach(function(par) {\n                self._drawParticle(viewInfo, ctx, par);\n            });\n        }\n    },\n\n    _drawParticle(viewInfo, ctx, par) {\n        let source = new L.latLng(par.y, par.x);\n        let target = new L.latLng(par.yt, par.xt);\n\n        if (\n            viewInfo.bounds.contains(source) &&\n            par.age <= this.options.maxAge\n        ) {\n            let pA = viewInfo.layer._map.latLngToContainerPoint(source);\n            let pB = viewInfo.layer._map.latLngToContainerPoint(target);\n\n            ctx.beginPath();\n            ctx.moveTo(pA.x, pA.y);\n            ctx.lineTo(pB.x, pB.y);\n\n            // next-step movement\n            par.x = par.xt;\n            par.y = par.yt;\n\n            // colormap vs. simple color\n            let color = this.options.color;\n            if (typeof color === 'function') {\n                ctx.strokeStyle = color(par.m);\n            }\n\n            let width = this.options.width;\n            if (typeof width === 'function') {\n                ctx.lineWidth = width(par.m);\n            }\n\n            ctx.stroke();\n        }\n    },\n\n    _prepareParticlePaths: function() {\n        let paths = [];\n\n        for (var i = 0; i < this.options.paths; i++) {\n            let p = this._field.randomPosition();\n            p.age = this._randomAge();\n            paths.push(p);\n        }\n        return paths;\n    },\n\n    _randomAge: function() {\n        return Math.floor(Math.random() * this.options.maxAge);\n    },\n\n    _stopAnimation: function() {\n        if (this.timer) {\n            this.timer.stop();\n        }\n    }\n});\n\nL.canvasLayer.vectorFieldAnim = function(vectorField, options) {\n    return new L.CanvasLayer.VectorFieldAnim(vectorField, options);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./layer/L.CanvasLayer.VectorFieldAnim.js","/*\n  1.0.1 (downloaded from https://github.com/Sumbera/gLayers.Leaflet/releases/tag/v1.0.1)\n\n  Generic  Canvas Layer for leaflet 0.7 and 1.0-rc,\n  copyright Stanislav Sumbera,  2016 , sumbera.com , license MIT\n  originally created and motivated by L.CanvasOverlay  available here: https://gist.github.com/Sumbera/11114288\n*/\n\nL.CanvasLayer = L.Layer.extend({\n    // -- initialized is called on prototype\n    initialize: function (options) {\n        this._map = null;\n        this._canvas = null;\n        this._frame = null;\n        this._delegate = null;\n        L.setOptions(this, options);\n    },\n\n    delegate: function (del) {\n        this._delegate = del;\n        return this;\n    },\n\n    needRedraw: function () {\n        if (!this._frame) {\n            this._frame = L.Util.requestAnimFrame(this.drawLayer, this);\n        }\n        return this;\n    },\n\n    //-------------------------------------------------------------\n    _onLayerDidResize: function (resizeEvent) {\n        this._canvas.width = resizeEvent.newSize.x;\n        this._canvas.height = resizeEvent.newSize.y;\n    },\n    //-------------------------------------------------------------\n    _onLayerDidMove: function () {\n        var topLeft = this._map.containerPointToLayerPoint([0, 0]);\n        L.DomUtil.setPosition(this._canvas, topLeft);\n        this.drawLayer();\n    },\n    //-------------------------------------------------------------\n    getEvents: function () {\n        var events = {\n            resize: this._onLayerDidResize,\n            moveend: this._onLayerDidMove\n        };\n        if (this._map.options.zoomAnimation && L.Browser.any3d) {\n            events.zoomanim = this._animateZoom;\n        }\n\n        return events;\n    },\n    //-------------------------------------------------------------\n    onAdd: function (map) {\n        this._map = map;\n        this._canvas = L.DomUtil.create('canvas', 'leaflet-layer');\n        this.tiles = {};\n\n        var size = this._map.getSize();\n        this._canvas.width = size.x;\n        this._canvas.height = size.y;\n\n        var animated = this._map.options.zoomAnimation && L.Browser.any3d;\n        L.DomUtil.addClass(this._canvas, 'leaflet-zoom-' + (animated ? 'animated' : 'hide'));\n\n\n        map._panes.overlayPane.appendChild(this._canvas);\n\n        map.on(this.getEvents(), this);\n\n        var del = this._delegate || this;\n        del.onLayerDidMount && del.onLayerDidMount(); // -- callback\n\n        this.needRedraw();\n    },\n\n    //-------------------------------------------------------------\n    onRemove: function (map) {\n        var del = this._delegate || this;\n        del.onLayerWillUnmount && del.onLayerWillUnmount(); // -- callback\n\n\n        map.getPanes().overlayPane.removeChild(this._canvas);\n\n        map.off(this.getEvents(), this);\n\n        this._canvas = null;\n\n    },\n\n    //------------------------------------------------------------\n    addTo: function (map) {\n        map.addLayer(this);\n        return this;\n    },\n    // --------------------------------------------------------------------------------\n    LatLonToMercator: function (latlon) {\n        return {\n            x: latlon.lng * 6378137 * Math.PI / 180,\n            y: Math.log(Math.tan((90 + latlon.lat) * Math.PI / 360)) * 6378137\n        };\n    },\n\n    //------------------------------------------------------------------------------\n    drawLayer: function () {\n        // -- todo make the viewInfo properties  flat objects.\n        var size = this._map.getSize();\n        var bounds = this._map.getBounds();\n        var zoom = this._map.getZoom();\n\n        var center = this.LatLonToMercator(this._map.getCenter());\n        var corner = this.LatLonToMercator(this._map.containerPointToLatLng(this._map.getSize()));\n\n        var del = this._delegate || this;\n        del.onDrawLayer && del.onDrawLayer({\n            layer: this,\n            canvas: this._canvas,\n            bounds: bounds,\n            size: size,\n            zoom: zoom,\n            center: center,\n            corner: corner\n        });\n        this._frame = null;\n    },\n\n    //------------------------------------------------------------------------------\n    _animateZoom: function (e) {\n        var scale = this._map.getZoomScale(e.zoom);\n        var offset = this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(), e.zoom, e.center);\n\n        L.DomUtil.setTransform(this._canvas, offset, scale);\n    }\n});\n\nL.canvasLayer = function () {\n    return new L.CanvasLayer();\n};\n\n\n\n// WEBPACK FOOTER //\n// ./layer/L.CanvasLayer.js","var invariant = require('@turf/invariant');\nvar getCoord = invariant.getCoord;\nvar getCoords = invariant.getCoords;\n\n// http://en.wikipedia.org/wiki/Even%E2%80%93odd_rule\n// modified from: https://github.com/substack/point-in-polygon/blob/master/index.js\n// which was modified from http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html\n\n/**\n * Takes a {@link Point} and a {@link Polygon} or {@link MultiPolygon} and determines if the point resides inside the polygon. The polygon can\n * be convex or concave. The function accounts for holes.\n *\n * @name inside\n * @param {Feature<Point>} point input point\n * @param {Feature<Polygon|MultiPolygon>} polygon input polygon or multipolygon\n * @param {boolean} [ignoreBoundary=false] True if polygon boundary should be ignored when determining if the point is inside the polygon otherwise false.\n * @returns {boolean} `true` if the Point is inside the Polygon; `false` if the Point is not inside the Polygon\n * @example\n * var pt = turf.point([-77, 44]);\n * var poly = turf.polygon([[\n *   [-81, 41],\n *   [-81, 47],\n *   [-72, 47],\n *   [-72, 41],\n *   [-81, 41]\n * ]]);\n *\n * turf.inside(pt, poly);\n * //= true\n */\nmodule.exports = function (point, polygon, ignoreBoundary) {\n    // validation\n    if (!point) throw new Error('point is required');\n    if (!polygon) throw new Error('polygon is required');\n\n    var pt = getCoord(point);\n    var polys = getCoords(polygon);\n    var type = (polygon.geometry) ? polygon.geometry.type : polygon.type;\n    var bbox = polygon.bbox;\n\n    // Quick elimination if point is not inside bbox\n    if (bbox && inBBox(pt, bbox) === false) return false;\n\n    // normalize to multipolygon\n    if (type === 'Polygon') polys = [polys];\n\n    for (var i = 0, insidePoly = false; i < polys.length && !insidePoly; i++) {\n        // check if it is in the outer ring first\n        if (inRing(pt, polys[i][0], ignoreBoundary)) {\n            var inHole = false;\n            var k = 1;\n            // check for the point in any of the holes\n            while (k < polys[i].length && !inHole) {\n                if (inRing(pt, polys[i][k], !ignoreBoundary)) {\n                    inHole = true;\n                }\n                k++;\n            }\n            if (!inHole) insidePoly = true;\n        }\n    }\n    return insidePoly;\n};\n\n/**\n * inRing\n *\n * @private\n * @param {[number, number]} pt [x,y]\n * @param {Array<[number, number]>} ring [[x,y], [x,y],..]\n * @param {boolean} ignoreBoundary ignoreBoundary\n * @returns {boolean} inRing\n */\nfunction inRing(pt, ring, ignoreBoundary) {\n    var isInside = false;\n    if (ring[0][0] === ring[ring.length - 1][0] && ring[0][1] === ring[ring.length - 1][1]) ring = ring.slice(0, ring.length - 1);\n\n    for (var i = 0, j = ring.length - 1; i < ring.length; j = i++) {\n        var xi = ring[i][0], yi = ring[i][1];\n        var xj = ring[j][0], yj = ring[j][1];\n        var onBoundary = (pt[1] * (xi - xj) + yi * (xj - pt[0]) + yj * (pt[0] - xi) === 0) &&\n            ((xi - pt[0]) * (xj - pt[0]) <= 0) && ((yi - pt[1]) * (yj - pt[1]) <= 0);\n        if (onBoundary) return !ignoreBoundary;\n        var intersect = ((yi > pt[1]) !== (yj > pt[1])) &&\n        (pt[0] < (xj - xi) * (pt[1] - yi) / (yj - yi) + xi);\n        if (intersect) isInside = !isInside;\n    }\n    return isInside;\n}\n\n/**\n * inBBox\n *\n * @private\n * @param {[number, number]} pt point [x,y]\n * @param {[number, number, number, number]} bbox BBox [west, south, east, north]\n * @returns {boolean} true/false if point is inside BBox\n */\nfunction inBBox(pt, bbox) {\n    return bbox[0] <= pt[0] &&\n           bbox[1] <= pt[1] &&\n           bbox[2] >= pt[0] &&\n           bbox[3] >= pt[1];\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../~/@turf/inside/index.js\n// module id = 11\n// module chunks = 0","/**\n * Unwrap a coordinate from a Point Feature, Geometry or a single coordinate.\n *\n * @name getCoord\n * @param {Array<number>|Geometry<Point>|Feature<Point>} obj Object\n * @returns {Array<number>} coordinates\n * @example\n * var pt = turf.point([10, 10]);\n *\n * var coord = turf.getCoord(pt);\n * //= [10, 10]\n */\nfunction getCoord(obj) {\n    if (!obj) throw new Error('obj is required');\n\n    var coordinates = getCoords(obj);\n\n    // getCoord() must contain at least two numbers (Point)\n    if (coordinates.length > 1 &&\n        typeof coordinates[0] === 'number' &&\n        typeof coordinates[1] === 'number') {\n        return coordinates;\n    } else {\n        throw new Error('Coordinate is not a valid Point');\n    }\n}\n\n/**\n * Unwrap coordinates from a Feature, Geometry Object or an Array of numbers\n *\n * @name getCoords\n * @param {Array<number>|Geometry|Feature} obj Object\n * @returns {Array<number>} coordinates\n * @example\n * var poly = turf.polygon([[[119.32, -8.7], [119.55, -8.69], [119.51, -8.54], [119.32, -8.7]]]);\n *\n * var coord = turf.getCoords(poly);\n * //= [[[119.32, -8.7], [119.55, -8.69], [119.51, -8.54], [119.32, -8.7]]]\n */\nfunction getCoords(obj) {\n    if (!obj) throw new Error('obj is required');\n    var coordinates;\n\n    // Array of numbers\n    if (obj.length) {\n        coordinates = obj;\n\n    // Geometry Object\n    } else if (obj.coordinates) {\n        coordinates = obj.coordinates;\n\n    // Feature\n    } else if (obj.geometry && obj.geometry.coordinates) {\n        coordinates = obj.geometry.coordinates;\n    }\n    // Checks if coordinates contains a number\n    if (coordinates) {\n        containsNumber(coordinates);\n        return coordinates;\n    }\n    throw new Error('No valid coordinates');\n}\n\n/**\n * Checks if coordinates contains a number\n *\n * @name containsNumber\n * @param {Array<any>} coordinates GeoJSON Coordinates\n * @returns {boolean} true if Array contains a number\n */\nfunction containsNumber(coordinates) {\n    if (coordinates.length > 1 &&\n        typeof coordinates[0] === 'number' &&\n        typeof coordinates[1] === 'number') {\n        return true;\n    }\n\n    if (Array.isArray(coordinates[0]) && coordinates[0].length) {\n        return containsNumber(coordinates[0]);\n    }\n    throw new Error('coordinates must only contain numbers');\n}\n\n/**\n * Enforce expectations about types of GeoJSON objects for Turf.\n *\n * @name geojsonType\n * @param {GeoJSON} value any GeoJSON object\n * @param {string} type expected GeoJSON type\n * @param {string} name name of calling function\n * @throws {Error} if value is not the expected type.\n */\nfunction geojsonType(value, type, name) {\n    if (!type || !name) throw new Error('type and name required');\n\n    if (!value || value.type !== type) {\n        throw new Error('Invalid input to ' + name + ': must be a ' + type + ', given ' + value.type);\n    }\n}\n\n/**\n * Enforce expectations about types of {@link Feature} inputs for Turf.\n * Internally this uses {@link geojsonType} to judge geometry types.\n *\n * @name featureOf\n * @param {Feature} feature a feature with an expected geometry type\n * @param {string} type expected GeoJSON type\n * @param {string} name name of calling function\n * @throws {Error} error if value is not the expected type.\n */\nfunction featureOf(feature, type, name) {\n    if (!feature) throw new Error('No feature passed');\n    if (!name) throw new Error('.featureOf() requires a name');\n    if (!feature || feature.type !== 'Feature' || !feature.geometry) {\n        throw new Error('Invalid input to ' + name + ', Feature with geometry required');\n    }\n    if (!feature.geometry || feature.geometry.type !== type) {\n        throw new Error('Invalid input to ' + name + ': must be a ' + type + ', given ' + feature.geometry.type);\n    }\n}\n\n/**\n * Enforce expectations about types of {@link FeatureCollection} inputs for Turf.\n * Internally this uses {@link geojsonType} to judge geometry types.\n *\n * @name collectionOf\n * @param {FeatureCollection} featureCollection a FeatureCollection for which features will be judged\n * @param {string} type expected GeoJSON type\n * @param {string} name name of calling function\n * @throws {Error} if value is not the expected type.\n */\nfunction collectionOf(featureCollection, type, name) {\n    if (!featureCollection) throw new Error('No featureCollection passed');\n    if (!name) throw new Error('.collectionOf() requires a name');\n    if (!featureCollection || featureCollection.type !== 'FeatureCollection') {\n        throw new Error('Invalid input to ' + name + ', FeatureCollection required');\n    }\n    for (var i = 0; i < featureCollection.features.length; i++) {\n        var feature = featureCollection.features[i];\n        if (!feature || feature.type !== 'Feature' || !feature.geometry) {\n            throw new Error('Invalid input to ' + name + ', Feature with geometry required');\n        }\n        if (!feature.geometry || feature.geometry.type !== type) {\n            throw new Error('Invalid input to ' + name + ': must be a ' + type + ', given ' + feature.geometry.type);\n        }\n    }\n}\n\n/**\n * Get Geometry from Feature or Geometry Object\n *\n * @param {Feature|Geometry} geojson GeoJSON Feature or Geometry Object\n * @returns {Geometry|null} GeoJSON Geometry Object\n * @throws {Error} if geojson is not a Feature or Geometry Object\n * @example\n * var point = {\n *   \"type\": \"Feature\",\n *   \"properties\": {},\n *   \"geometry\": {\n *     \"type\": \"Point\",\n *     \"coordinates\": [110, 40]\n *   }\n * }\n * var geom = turf.getGeom(point)\n * //={\"type\": \"Point\", \"coordinates\": [110, 40]}\n */\nfunction getGeom(geojson) {\n    if (!geojson) throw new Error('geojson is required');\n    if (geojson.geometry !== undefined) return geojson.geometry;\n    if (geojson.coordinates || geojson.geometries) return geojson;\n    throw new Error('geojson must be a valid Feature or Geometry Object');\n}\n\n/**\n * Get Geometry Type from Feature or Geometry Object\n *\n * @param {Feature|Geometry} geojson GeoJSON Feature or Geometry Object\n * @returns {string} GeoJSON Geometry Type\n * @throws {Error} if geojson is not a Feature or Geometry Object\n * @example\n * var point = {\n *   \"type\": \"Feature\",\n *   \"properties\": {},\n *   \"geometry\": {\n *     \"type\": \"Point\",\n *     \"coordinates\": [110, 40]\n *   }\n * }\n * var geom = turf.getGeomType(point)\n * //=\"Point\"\n */\nfunction getGeomType(geojson) {\n    if (!geojson) throw new Error('geojson is required');\n    var geom = getGeom(geojson);\n    if (geom) return geom.type;\n}\n\nmodule.exports = {\n    geojsonType: geojsonType,\n    collectionOf: collectionOf,\n    featureOf: featureOf,\n    getCoord: getCoord,\n    getCoords: getCoords,\n    containsNumber: containsNumber,\n    getGeom: getGeom,\n    getGeomType: getGeomType\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../~/@turf/invariant/index.js\n// module id = 12\n// module chunks = 0","// base\nimport Vector from './Vector.js';\nwindow.L.Vector = Vector;\n\nimport Cell from './Cell.js';\nwindow.L.Cell = Cell;\n\nimport Field from './Field.js';\nwindow.L.Field = Field;\n\nimport ScalarField from './ScalarField.js';\nwindow.L.ScalarField = ScalarField;\n\nimport VectorField from './VectorField.js';\nwindow.L.VectorField = VectorField;\n\n// layer\nrequire('./layer/L.CanvasLayer.js');\nrequire('./layer/L.CanvasLayer.SimpleLonLat.js');\nrequire('./layer/L.CanvasLayer.Field.js');\nrequire('./layer/L.CanvasLayer.ScalarField.js');\nrequire('./layer/L.CanvasLayer.VectorFieldAnim.js');\n\n// control\nrequire('./control/L.Control.ColorBar.js');\n\n\n// WEBPACK FOOTER //\n// ./_main.js"],"sourceRoot":""}